<%- include('../header') %>
    <%- include('../left-sidebar') %>
        <form method="post" autocomplete="off" id="form_cron_scrape">
            <div class="page">
                <div class="container-fluid"></div>
                <div class="d-flex justify-content-between">
                    <h1 class="commanHeading">Configure Date Only Cron <b>
                        </b></h1>
                    <div class="d-flex">
                        <a onClick="edit()" class="btn btn-primary mx-1" name="btnEdit" style="color: white;"><i
                                class="fa-sharp fa-solid fa-pen"></i>
                            &nbsp;Edit</a>
                        <a onClick="cancel()" class="btn btn-danger mx-1 d-none" name="btnCancel"
                            style="color: white;"><i class="fa fa-times"></i>
                            &nbsp;Cancel</a>
                        <a onClick="saveScrapeCron()" class="btn btn-success mx-1 disabled" name="btnSave"
                            aria-disabled="true" style="color: white;"><i class="fa-sharp fa-solid fa-house"></i>
                            &nbsp;Save</a>
                    </div>
                </div>
                <hr>
                <div class="card">
                    <div class="body table-responsive">
                        <table id="example" class="table table-striped table-bordered">
                            <thead>
                                <tr>
                                    <th style="display: none;">Cron Id</th>
                                    <th>Data Only Cron Name</th>
                                    <th style="width: 135px;">Cron Unit</th>
                                    <th style="width: 100px;">Cron Interval</th>
                                    <th style="width: 100px;">Cron Offset</th>
                                    <th>Default Proxy Provider</th>
                                    <th>Alternate Provider List</th>
                                    <th>Last Modified By</th>
                                    <th>Last Modified On</th>
                                    <th>Last Updated On</th>
                                    <th style="text-align: center;">Cron Start/Stop</th>
                                </tr>
                            </thead>
                            <tbody>
                                <% if(scrapeCronData.length===0) { %>
                                    <p>No items found !</p>
                                    <% } else { let i=1 ; scrapeCronData.forEach(function(item){%>
                                        <tr>
                                            <td style="display: none;">
                                                <input type="text" class="form-control" value="<%= item.CronId %>"
                                                    name="cron_id" placeholder="Cron Id" readonly />
                                                <input type="hidden" class="form-control" value="<%= item.CronId %>"
                                                    name="cron_id_hdn" />
                                            </td>
                                            <td>
                                                <input type="text" class="form-control" value="<%= item.CronName %>"
                                                    name="scr_cron_name" placeholder="Cron Name" readonly />
                                            </td>
                                            <td>
                                                <select class="form-select form-control" name="scr_cron_time_unit"
                                                    aria-label="Default select example" disabled>
                                                    <option <%=item.CronTimeUnit=="sec" ? "selected" : "" %>
                                                        value="sec">Seconds</option>
                                                    <option <%=item.CronTimeUnit=="min" ? "selected" : "" %>
                                                        value="min">Minutes</option>
                                                    <option <%=item.CronTimeUnit=="hours" ? "selected" : "" %>
                                                        value="hours">Hours</option>
                                                    <option <%=item.CronTimeUnit=="days" ? "selected" : "" %>
                                                        value="days">Days</option>
                                                </select>
                                            </td>
                                            <td>
                                                <input type="number" class="form-control" value="<%= item.CronTime %>"
                                                    name="scr_cron_time" placeholder="Cron Time" readonly />
                                            </td>
                                            <td>
                                                <input type="number" class="form-control"
                                                    value="<%= item.Offset || 0 %>" min="0" name="scr_offset"
                                                    placeholder="Offset" readonly />
                                            </td>
                                            <td>
                                                <select class="form-select form-control" name="scr_proxy_provider" aria-label="Default select example" disabled title="<%= item.ProxyProvider_Name %>">
                                                    <% configItems.forEach(function(configItem) { %>
                                                        <option value="<%=configItem.proxyProvider%>" <%=configItem.proxyProvider === item.ProxyProvider ? "selected" : "" %>>
                                                            <%=configItem.proxyProviderName%><%= configItem.method ? ' - ' + configItem.method : '' %>
                                                        </option>
                                                    <% }); %>
                                                </select>
                                            </td>
                                            <td>
                                                <select class="form-select form-control" name="proxy_provider_1" aria-label="Default select example" disabled title="<%= item.ProxyProvider_1_Name %>">
                                                    <% configItems.forEach(function(configItem) { %>
                                                        <option value="<%=configItem.proxyProvider%>" <%=configItem.proxyProvider === item.ProxyProvider_1 ? "selected" : "" %>>
                                                            <%=configItem.proxyProviderName%><%= configItem.method ? ' - ' + configItem.method : '' %>
                                                        </option>
                                                    <% }); %>
                                                </select>
                                                <br />
                                                <select class="form-select form-control" name="proxy_provider_2" aria-label="Default select example" disabled title="<%= item.ProxyProvider_2_Name %>">
                                                    <% configItems.forEach(function(configItem) { %>
                                                        <option value="<%=configItem.proxyProvider%>" <%=configItem.proxyProvider === item.ProxyProvider_2 ? "selected" : "" %>>
                                                            <%=configItem.proxyProviderName%><%= configItem.method ? ' - ' + configItem.method : '' %>
                                                        </option>
                                                    <% }); %>
                                                </select>
                                                <br />
                                                <select class="form-select form-control" name="proxy_provider_3" aria-label="Default select example" disabled title="<%= item.ProxyProvider_3_Name %>">
                                                    <% configItems.forEach(function(configItem) { %>
                                                        <option value="<%=configItem.proxyProvider%>" <%=configItem.proxyProvider === item.ProxyProvider_3 ? "selected" : "" %>>
                                                            <%=configItem.proxyProviderName%><%= configItem.method ? ' - ' + configItem.method : '' %>
                                                        </option>
                                                    <% }); %>
                                                </select>
                                                <br />
                                                <select class="form-select form-control" name="proxy_provider_4" aria-label="Default select example" disabled title="<%= item.ProxyProvider_4_Name %>">
                                                    <% configItems.forEach(function(configItem) { %>
                                                        <option value="<%=configItem.proxyProvider%>" <%=configItem.proxyProvider === item.ProxyProvider_4 ? "selected" : "" %>>
                                                            <%=configItem.proxyProviderName%><%= configItem.method ? ' - ' + configItem.method : '' %>
                                                        </option>
                                                    <% }); %>
                                                </select>
                                                <br />
                                                <select class="form-select form-control" name="proxy_provider_5" aria-label="Default select example" disabled title="<%= item.ProxyProvider_5_Name %>">
                                                    <% configItems.forEach(function(configItem) { %>
                                                        <option value="<%=configItem.proxyProvider%>" <%=configItem.proxyProvider === item.ProxyProvider_5 ? "selected" : "" %>>
                                                            <%=configItem.proxyProviderName%><%= configItem.method ? ' - ' + configItem.method : '' %>
                                                        </option>
                                                    <% }); %>
                                                </select>
                                                <br />
                                                <select class="form-select form-control" name="proxy_provider_6" aria-label="Default select example" disabled title="<%= item.ProxyProvider_6_Name %>">
                                                    <% configItems.forEach(function(configItem) { %>
                                                        <option value="<%=configItem.proxyProvider%>" <%=configItem.proxyProvider===item.ProxyProvider_6 ? "selected"
                                                            : "" %>>
                                                            <%=configItem.proxyProviderName%>
                                                                <%= configItem.method ? ' - ' + configItem.method : '' %>
                                                        </option>
                                                        <% }); %>
                                                </select>
                                            </td>
                                            <td style="width:max-content">
                                                <%= item.lastUpdatedBy %>
                                            </td>
                                            <td style="width:max-content">
                                                <%= item.lastUpdatedOn %>
                                            </td>
                                            <td style="width:max-content">
                                                <%= item.UpdatedTime %>
                                            </td>
                                            <td style="text-align: center;">
                                                <% if(item.status=="true" ) { %>
                                                    <button type="button" onclick="switchOffCron('<%= item.CronId %>')"
                                                        class="btn btn-danger" style="width:70px;">STOP</button>
                                                    <% }else{ %>
                                                        <button type="button"
                                                            onclick="switchOnCron('<%= item.CronId %>')"
                                                            class="btn btn-success" style="width:70px;">START</button>
                                                        <% } %>
                                            </td>
                                        </tr>
                                        <% }); } %>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            </div>
        </form>
        <%- include("../footer"); %>
            <style>
                /* Basic Rules */
                .switch input {
                    display: none;
                }

                #form_cron_scrape {
                    padding-left: 15px;
                    padding-right: 15px;
                }

                /* .page {
                left: 270px !important;
                width: calc(100% - 280px) !important;
            } */
                .switch {
                    display: inline-block;
                    width: 52px;
                    height: 22px;
                    margin: 8px;
                    transform: translateY(50%);
                    position: relative;
                }

                /* Style Wired */
                .slider {
                    position: absolute;
                    top: 0;
                    bottom: 0;
                    left: 0;
                    right: 0;
                    border-radius: 30px;
                    box-shadow: 0 0 0 2px #777, 0 0 4px #777;
                    cursor: pointer;
                    border: 4px solid transparent;
                    overflow: hidden;
                    transition: 0.4s;
                }

                .slider:before {
                    position: absolute;
                    content: "";
                    width: 100%;
                    height: 100%;
                    background: #777;
                    border-radius: 30px;
                    transform: translateX(-30px);
                    transition: 0.4s;
                }

                input:checked+.slider:before {
                    transform: translateX(30px);
                    background: limeGreen;
                }

                input:checked+.slider {
                    box-shadow: 0 0 0 2px limeGreen, 0 0 2px limeGreen;
                }

                /* Style Flat */
                .switch.flat .slider {
                    box-shadow: none;
                }

                .switch.flat .slider:before {
                    background: #fff;
                }

                .switch.flat input:checked+.slider:before {
                    background: white;
                }

                .switch.flat input:checked+.slider {
                    background: limeGreen;
                }

                .threshold {
                    background-color: #FAC2B9 !important;
                }

                .closeThreshold {
                    background-color: #ffe066 !important;
                }

                .p1 {
                    padding: 10px;
                }
            </style>
            <script src="/javascripts/dashboard.js"></script>
            <script src="/javascripts/scrapeCronSettings.js"></script>