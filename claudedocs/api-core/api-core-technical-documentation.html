<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API-Core Technical Documentation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f5f5;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }

        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 3rem 2rem;
            border-bottom: 4px solid #5568d3;
        }

        header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .meta-info {
            background: rgba(255,255,255,0.1);
            padding: 1rem;
            margin-top: 1.5rem;
            border-radius: 8px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .meta-info div {
            display: flex;
            flex-direction: column;
        }

        .meta-info strong {
            font-size: 0.85rem;
            opacity: 0.8;
            margin-bottom: 0.25rem;
        }

        .meta-info span {
            font-size: 1.1rem;
        }

        nav {
            background: #f8f9fa;
            padding: 1.5rem 2rem;
            border-bottom: 2px solid #e9ecef;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        nav h2 {
            font-size: 0.9rem;
            color: #6c757d;
            margin-bottom: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        nav ul {
            list-style: none;
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        nav a {
            color: #667eea;
            text-decoration: none;
            padding: 0.5rem 1rem;
            background: white;
            border-radius: 6px;
            border: 1px solid #e9ecef;
            transition: all 0.2s;
            font-size: 0.9rem;
        }

        nav a:hover {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .content {
            padding: 2rem;
        }

        section {
            margin-bottom: 3rem;
            scroll-margin-top: 100px;
        }

        h2 {
            color: #667eea;
            font-size: 2rem;
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 3px solid #667eea;
        }

        h3 {
            color: #764ba2;
            font-size: 1.5rem;
            margin: 2rem 0 1rem 0;
        }

        h4 {
            color: #495057;
            font-size: 1.2rem;
            margin: 1.5rem 0 0.75rem 0;
        }

        p {
            margin-bottom: 1rem;
            color: #495057;
        }

        .card {
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 1.5rem;
            border-left: 4px solid #667eea;
        }

        .card h4 {
            margin-top: 0;
            color: #667eea;
        }

        ul, ol {
            margin-left: 2rem;
            margin-bottom: 1rem;
        }

        li {
            margin-bottom: 0.5rem;
            color: #495057;
        }

        code {
            background: #f1f3f5;
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.9em;
            color: #e83e8c;
        }

        pre {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 1.5rem;
            border-radius: 8px;
            overflow-x: auto;
            margin-bottom: 1.5rem;
            border-left: 4px solid #667eea;
        }

        pre code {
            background: none;
            color: inherit;
            padding: 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 1.5rem;
            background: white;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        th {
            background: #667eea;
            color: white;
            padding: 1rem;
            text-align: left;
            font-weight: 600;
        }

        td {
            padding: 1rem;
            border-bottom: 1px solid #e9ecef;
        }

        tr:hover {
            background: #f8f9fa;
        }

        .badge {
            display: inline-block;
            padding: 0.25rem 0.6rem;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-right: 0.5rem;
        }

        .badge-get { background: #28a745; color: white; }
        .badge-post { background: #007bff; color: white; }
        .badge-put { background: #ffc107; color: #212529; }
        .badge-delete { background: #dc3545; color: white; }
        .badge-cron { background: #6f42c1; color: white; }
        .badge-v1 { background: #17a2b8; color: white; }
        .badge-v2 { background: #fd7e14; color: white; }

        .highlight-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 1rem;
            margin-bottom: 1.5rem;
            border-radius: 4px;
        }

        .info-box {
            background: #d1ecf1;
            border-left: 4px solid #17a2b8;
            padding: 1rem;
            margin-bottom: 1.5rem;
            border-radius: 4px;
        }

        .grid-2 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        footer {
            background: #2d3748;
            color: white;
            padding: 2rem;
            text-align: center;
            margin-top: 3rem;
        }

        footer p {
            color: #cbd5e0;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>API-Core Technical Documentation</h1>
            <p>Comprehensive guide to the Repricer API Core application architecture, endpoints, and implementation</p>
            <div class="meta-info">
                <div>
                    <strong>Version</strong>
                    <span>1.0.2</span>
                </div>
                <div>
                    <strong>Runtime</strong>
                    <span>Node.js + Express</span>
                </div>
                <div>
                    <strong>Language</strong>
                    <span>TypeScript</span>
                </div>
                <div>
                    <strong>Port</strong>
                    <span>5001 (default)</span>
                </div>
            </div>
        </header>

        <nav>
            <h2>Table of Contents</h2>
            <ul>
                <li><a href="#overview">Overview</a></li>
                <li><a href="#architecture">Architecture</a></li>
                <li><a href="#api-endpoints">API Endpoints</a></li>
                <li><a href="#repricing-algorithms">Repricing Algorithms</a></li>
                <li><a href="#cron-system">Cron System</a></li>
                <li><a href="#data-models">Data Models</a></li>
                <li><a href="#database">Database Integration</a></li>
                <li><a href="#configuration">Configuration</a></li>
                <li><a href="#utilities">Utilities</a></li>
                <li><a href="#deployment">Deployment</a></li>
            </ul>
        </nav>

        <div class="content">
            <!-- OVERVIEW -->
            <section id="overview">
                <h2>Overview</h2>
                <p>
                    The <strong>api-core</strong> application is a comprehensive automated repricing system for dental supply vendors operating on the Net32 marketplace.
                    It provides sophisticated price optimization algorithms, automated cron-based execution, and multi-vendor support with real-time price monitoring and adjustment capabilities.
                </p>

                <div class="highlight-box">
                    <strong>Key Business Purpose:</strong> Automatically adjust product pricing to maintain competitive positions while respecting floor/ceiling constraints and maximizing profitability.
                </div>

                <h3>Core Capabilities</h3>
                <div class="grid-2">
                    <div class="card">
                        <h4>Automated Repricing</h4>
                        <ul>
                            <li>Two algorithm versions (V1 and V2)</li>
                            <li>Buy-box optimization</li>
                            <li>Quantity-based pricing strategies</li>
                            <li>Competitor price monitoring</li>
                        </ul>
                    </div>
                    <div class="card">
                        <h4>Cron Management</h4>
                        <ul>
                            <li>Regular product cron jobs</li>
                            <li>Slow cron group execution</li>
                            <li>Feed-based repricing</li>
                            <li>Scraping cron for data collection</li>
                        </ul>
                    </div>
                    <div class="card">
                        <h4>Multi-Vendor Support</h4>
                        <ul>
                            <li>Tradent (17357)</li>
                            <li>Frontier (20722)</li>
                            <li>MVP (20755)</li>
                            <li>FirstDent (20533)</li>
                            <li>TopDent (20727)</li>
                            <li>Triad (5)</li>
                        </ul>
                    </div>
                    <div class="card">
                        <h4>Data Management</h4>
                        <ul>
                            <li>MongoDB for operational data</li>
                            <li>MySQL for product/historical data</li>
                            <li>Redis caching support</li>
                            <li>Comprehensive history tracking</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- ARCHITECTURE -->
            <section id="architecture">
                <h2>Architecture & Design Patterns</h2>

                <h3>Application Structure</h3>
                <p>The application follows a layered architecture with clear separation of concerns:</p>

                <pre><code>apps/api-core/
├── src/
│   ├── controller/           # HTTP request handlers & routing
│   │   ├── main-cron/       # Main cron job management
│   │   ├── slow-cron-group/ # Slow execution cron jobs
│   │   ├── scrape-cron/     # Web scraping cron jobs
│   │   ├── filter-cron/     # Product filtering cron
│   │   ├── manual-repricer/ # Manual repricing endpoints
│   │   └── search/          # Search & query endpoints
│   ├── model/               # Data models & schemas
│   │   ├── sql-models/      # MySQL entity models
│   │   └── user-models/     # User-defined models
│   ├── services/            # Business logic services
│   ├── utility/             # Helper functions & utilities
│   │   ├── mongo/           # MongoDB operations
│   │   ├── mysql/           # MySQL operations
│   │   ├── reprice-algo/    # Repricing algorithms
│   │   │   ├── v1/          # Version 1 algorithm
│   │   │   └── v2/          # Version 2 algorithm
│   │   ├── proxy/           # Proxy management
│   │   └── net32/           # Net32 API integration
│   ├── types/               # TypeScript type definitions
│   ├── resources/           # Static resources & mappings
│   ├── client/              # External client integrations
│   └── main.ts              # Application entry point
├── package.json
└── Dockerfile</code></pre>

                <h3>Design Patterns</h3>
                <div class="grid-2">
                    <div class="card">
                        <h4>Router Pattern</h4>
                        <p>Express routers organize endpoints by functional domain (cron, feed, search, manual repricer)</p>
                    </div>
                    <div class="card">
                        <h4>Service Layer</h4>
                        <p>Business logic separated from HTTP handlers for testability and reusability</p>
                    </div>
                    <div class="card">
                        <h4>Repository Pattern</h4>
                        <p>Database operations abstracted through helper modules (mongo-helper, mysql-helper)</p>
                    </div>
                    <div class="card">
                        <h4>Strategy Pattern</h4>
                        <p>Multiple repricing algorithms (V1, V2) with pluggable implementations</p>
                    </div>
                </div>

                <h3>Technology Stack</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Category</th>
                            <th>Technology</th>
                            <th>Purpose</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Runtime</td>
                            <td>Node.js + TypeScript</td>
                            <td>Type-safe server-side execution</td>
                        </tr>
                        <tr>
                            <td>Web Framework</td>
                            <td>Express 5.x</td>
                            <td>HTTP server & routing</td>
                        </tr>
                        <tr>
                            <td>Primary Database</td>
                            <td>MongoDB 4.x (Mongoose)</td>
                            <td>Operational data, cron settings, logs</td>
                        </tr>
                        <tr>
                            <td>Secondary Database</td>
                            <td>MySQL 2.x (Knex)</td>
                            <td>Product details, price history, run tracking</td>
                        </tr>
                        <tr>
                            <td>Caching</td>
                            <td>Redis 5.x + node-cache</td>
                            <td>Performance optimization</td>
                        </tr>
                        <tr>
                            <td>Job Scheduling</td>
                            <td>node-cron 3.x</td>
                            <td>Automated task execution</td>
                        </tr>
                        <tr>
                            <td>Web Scraping</td>
                            <td>Puppeteer, Cheerio, ScrapingBee</td>
                            <td>Competitor data collection</td>
                        </tr>
                        <tr>
                            <td>HTTP Client</td>
                            <td>Axios with retry</td>
                            <td>External API communication</td>
                        </tr>
                        <tr>
                            <td>Validation</td>
                            <td>Zod, express-validator</td>
                            <td>Schema & input validation</td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <!-- API ENDPOINTS -->
            <section id="api-endpoints">
                <h2>API Endpoints</h2>

                <h3>Feed Controller - Product Repricing</h3>
                <div class="card">
                    <h4><span class="badge badge-post">POST</span> /feed/RepriceProduct/:id</h4>
                    <p><strong>Purpose:</strong> Reprice a specific product based on current market conditions</p>
                    <p><strong>Parameters:</strong></p>
                    <ul>
                        <li><code>id</code> - Product MPID (Master Product ID)</li>
                    </ul>
                    <p><strong>Request Body:</strong> Product details including pricing rules, floor/max prices, competitor settings</p>
                    <p><strong>Response:</strong> Repricing decision with suggested price and reasoning</p>
                    <p><strong>Key Logic:</strong></p>
                    <ol>
                        <li>Validate product activation status</li>
                        <li>Check repricing eligibility</li>
                        <li>Fetch sister vendor details if competeAll=false</li>
                        <li>Get current Net32 marketplace data</li>
                        <li>Apply repricing algorithm (V1 or V2)</li>
                        <li>Generate price recommendation with justification</li>
                    </ol>
                </div>

                <h3>Main Cron Controller - Job Management</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Method</th>
                            <th>Endpoint</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><span class="badge badge-get">GET</span></td>
                            <td>/schedule/StartCronV3</td>
                            <td>Start all enabled cron jobs</td>
                        </tr>
                        <tr>
                            <td><span class="badge badge-get">GET</span></td>
                            <td>/schedule/StopAll</td>
                            <td>Stop all running cron jobs</td>
                        </tr>
                        <tr>
                            <td><span class="badge badge-post">POST</span></td>
                            <td>/schedule/StartCron</td>
                            <td>Start specific cron job by ID</td>
                        </tr>
                        <tr>
                            <td><span class="badge badge-post">POST</span></td>
                            <td>/schedule/StopCron</td>
                            <td>Stop specific cron job by ID</td>
                        </tr>
                        <tr>
                            <td><span class="badge badge-post">POST</span></td>
                            <td>/schedule/RecreateCron</td>
                            <td>Recreate cron job with new settings</td>
                        </tr>
                        <tr>
                            <td><span class="badge badge-get">GET</span></td>
                            <td>/schedule/start422</td>
                            <td>Start 422 error handling cron</td>
                        </tr>
                        <tr>
                            <td><span class="badge badge-get">GET</span></td>
                            <td>/schedule/startOverride</td>
                            <td>Start override priority cron</td>
                        </tr>
                        <tr>
                            <td><span class="badge badge-get">GET</span></td>
                            <td>/schedule/startFeedCron</td>
                            <td>Start feed-based repricing cron</td>
                        </tr>
                        <tr>
                            <td><span class="badge badge-get">GET</span></td>
                            <td>/schedule/startProductCron</td>
                            <td>Start product update cron</td>
                        </tr>
                        <tr>
                            <td><span class="badge badge-get">GET</span></td>
                            <td>/schedule/startManagedServiceCron</td>
                            <td>Start managed service cron</td>
                        </tr>
                        <tr>
                            <td><span class="badge badge-get">GET</span></td>
                            <td>/schedule/start_specific_cron/:key</td>
                            <td>Start cron by specific key identifier</td>
                        </tr>
                    </tbody>
                </table>

                <h3>Manual Repricer Controller</h3>
                <div class="card">
                    <h4><span class="badge badge-get">GET</span> /repricer/ManualUpdate/:id</h4>
                    <p>Manually trigger repricing for a specific product</p>
                </div>
                <div class="card">
                    <h4><span class="badge badge-get">GET</span> /repricer/UpdateToMax/:id</h4>
                    <p>Update product price to maximum allowed price</p>
                </div>
                <div class="card">
                    <h4><span class="badge badge-post">POST</span> /repricer/V2AlgoTest/:mpid</h4>
                    <p>Test V2 algorithm execution for a product (testing/debugging endpoint)</p>
                </div>

                <h3>Search Controller</h3>
                <div class="card">
                    <h4><span class="badge badge-post">POST</span> /search/RepriceProductToMax/:id</h4>
                    <p>Reprice product to maximum competitive price</p>
                </div>

                <h3>Slow Cron Group Controller</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Method</th>
                            <th>Endpoint</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><span class="badge badge-get">GET</span></td>
                            <td>/slow-cron-group/start</td>
                            <td>Start slow execution cron jobs</td>
                        </tr>
                        <tr>
                            <td><span class="badge badge-post">POST</span></td>
                            <td>/slow-cron-group/start-specific</td>
                            <td>Start specific slow cron job</td>
                        </tr>
                        <tr>
                            <td><span class="badge badge-post">POST</span></td>
                            <td>/slow-cron-group/toggle-status</td>
                            <td>Enable/disable slow cron job</td>
                        </tr>
                        <tr>
                            <td><span class="badge badge-post">POST</span></td>
                            <td>/slow-cron-group/recreate</td>
                            <td>Recreate slow cron configuration</td>
                        </tr>
                    </tbody>
                </table>

                <h3>Scrape Cron Controller</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Method</th>
                            <th>Endpoint</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><span class="badge badge-get">GET</span></td>
                            <td>/scrape-cron/start</td>
                            <td>Start web scraping cron jobs</td>
                        </tr>
                        <tr>
                            <td><span class="badge badge-post">POST</span></td>
                            <td>/scrape-cron/run</td>
                            <td>Execute scraping job immediately</td>
                        </tr>
                        <tr>
                            <td><span class="badge badge-post">POST</span></td>
                            <td>/scrape-cron/toggle-status</td>
                            <td>Enable/disable scraping cron</td>
                        </tr>
                        <tr>
                            <td><span class="badge badge-post">POST</span></td>
                            <td>/scrape-cron/recreate</td>
                            <td>Recreate scraping configuration</td>
                        </tr>
                    </tbody>
                </table>

                <h3>Filter Cron Controller</h3>
                <div class="info-box">
                    <strong>Purpose:</strong> Manages product filtering operations based on eligibility criteria and update schedules
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>Method</th>
                            <th>Endpoint</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><span class="badge badge-get">GET</span></td>
                            <td>/filter-cron/start</td>
                            <td>Start product filter cron</td>
                        </tr>
                        <tr>
                            <td><span class="badge badge-post">POST</span></td>
                            <td>/filter-cron/toggle-status</td>
                            <td>Enable/disable filter cron</td>
                        </tr>
                        <tr>
                            <td><span class="badge badge-post">POST</span></td>
                            <td>/filter-cron/recreate</td>
                            <td>Recreate filter configuration</td>
                        </tr>
                    </tbody>
                </table>

                <h3>Utility Endpoints</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Method</th>
                            <th>Endpoint</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><span class="badge badge-get">GET</span></td>
                            <td>/health</td>
                            <td>Health check endpoint (returns 200 OK)</td>
                        </tr>
                        <tr>
                            <td><span class="badge badge-get">GET</span></td>
                            <td>/api/GetStatus</td>
                            <td>Get application server status</td>
                        </tr>
                        <tr>
                            <td><span class="badge badge-get">GET</span></td>
                            <td>/cache/*</td>
                            <td>Cache management operations</td>
                        </tr>
                        <tr>
                            <td><span class="badge badge-get">GET</span></td>
                            <td>/debug/*</td>
                            <td>Debug and diagnostic endpoints</td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <!-- REPRICING ALGORITHMS -->
            <section id="repricing-algorithms">
                <h2>Repricing Algorithms</h2>

                <p>The application supports two versions of repricing algorithms with distinct strategies and capabilities.</p>

                <h3><span class="badge badge-v1">V1</span> Algorithm (Legacy)</h3>
                <div class="card">
                    <h4>Location: <code>src/utility/reprice-algo/v1/</code></h4>
                    <p><strong>Key Components:</strong></p>
                    <ul>
                        <li><code>algo-v1.ts</code> - Main repricing logic</li>
                        <li><code>repricer-rule-helper.ts</code> - Business rule implementations</li>
                        <li><code>reprice-helper.ts</code> - Repricing utilities (compete all)</li>
                        <li><code>reprice-helper-nc.ts</code> - Repricing utilities (no compete all)</li>
                    </ul>

                    <p><strong>Core Functions:</strong></p>
                    <ul>
                        <li><code>repriceProduct()</code> - Primary repricing function</li>
                        <li><code>repriceProductToMax()</code> - Maximum price repricing</li>
                    </ul>

                    <p><strong>Strategy Overview:</strong></p>
                    <ol>
                        <li>Evaluate current market position</li>
                        <li>Apply business rules and constraints</li>
                        <li>Calculate competitive pricing</li>
                        <li>Consider sister vendor pricing (if applicable)</li>
                        <li>Respect floor/ceiling price boundaries</li>
                        <li>Generate price recommendation</li>
                    </ol>
                </div>

                <h3><span class="badge badge-v2">V2</span> Algorithm (Current)</h3>
                <div class="card">
                    <h4>Location: <code>src/utility/reprice-algo/v2/</code></h4>
                    <p><strong>Advanced Features:</strong></p>
                    <ul>
                        <li>Buy-box optimization logic</li>
                        <li>Sophisticated quantity break handling</li>
                        <li>Multi-quantity competitive analysis</li>
                        <li>Shipping threshold calculations</li>
                        <li>Badge-aware ranking</li>
                        <li>HTML output generation for debugging</li>
                    </ul>

                    <p><strong>Key Files:</strong></p>
                    <ul>
                        <li><code>algorithm.ts</code> - Core V2 logic with 40+ functions</li>
                        <li><code>wrapper.ts</code> - V2 algorithm wrapper and orchestration</li>
                        <li><code>settings.ts</code> - Configuration and settings management</li>
                        <li><code>shipping-threshold.ts</code> - Shipping cost calculations</li>
                        <li><code>threshold-scraping.ts</code> - Dynamic threshold discovery</li>
                        <li><code>html-builder.ts</code> - Debug visualization generation</li>
                        <li><code>utility.ts</code> - Helper functions</li>
                        <li><code>types.ts</code> - TypeScript type definitions</li>
                    </ul>

                    <p><strong>Critical Functions:</strong></p>
                    <table>
                        <thead>
                            <tr>
                                <th>Function</th>
                                <th>Purpose</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>repriceProductV2()</code></td>
                                <td>Main entry point for V2 algorithm</td>
                            </tr>
                            <tr>
                                <td><code>getOptimalSolutionForBoard()</code></td>
                                <td>Find optimal pricing across quantity breaks</td>
                            </tr>
                            <tr>
                                <td><code>getBestCompetitivePriceForBuyBox()</code></td>
                                <td>Calculate competitive price for buy-box position</td>
                            </tr>
                            <tr>
                                <td><code>getExpectedRank()</code></td>
                                <td>Predict ranking with proposed price</td>
                            </tr>
                            <tr>
                                <td><code>getExpectedRankByBuyBox()</code></td>
                                <td>Predict buy-box rank</td>
                            </tr>
                            <tr>
                                <td><code>getExpectedRankByTotalPrice()</code></td>
                                <td>Predict rank by total cost</td>
                            </tr>
                            <tr>
                                <td><code>getExpectedRankByUnitPrice()</code></td>
                                <td>Predict rank by unit price</td>
                            </tr>
                            <tr>
                                <td><code>computeTargetUnitPrice()</code></td>
                                <td>Calculate target unit price</td>
                            </tr>
                            <tr>
                                <td><code>getShippingBucket()</code></td>
                                <td>Determine shipping cost tier</td>
                            </tr>
                            <tr>
                                <td><code>removeUnnecessaryQuantityBreaks()</code></td>
                                <td>Optimize quantity break structure</td>
                            </tr>
                        </tbody>
                    </table>

                    <p><strong>Buy-Box Strategy:</strong></p>
                    <div class="info-box">
                        The V2 algorithm prioritizes achieving and maintaining the "buy-box" position - the featured offer that appears
                        prominently on product pages. It evaluates multiple factors including:
                        <ul>
                            <li>Unit price competitiveness</li>
                            <li>Total cost at various quantities</li>
                            <li>Shipping thresholds and costs</li>
                            <li>Vendor badge status (verified, trusted, etc.)</li>
                            <li>Quantity break effectiveness</li>
                        </ul>
                    </div>
                </div>

                <h3>Algorithm Selection</h3>
                <p>The algorithm version is determined by product configuration settings stored in the database. V2 is the recommended
                algorithm for new implementations due to its advanced buy-box optimization and multi-quantity analysis capabilities.</p>
            </section>

            <!-- CRON SYSTEM -->
            <section id="cron-system">
                <h2>Cron Job System</h2>

                <p>The application implements a sophisticated cron job management system for automated repricing operations.</p>

                <h3>Cron Types</h3>
                <div class="grid-2">
                    <div class="card">
                        <h4><span class="badge badge-cron">Regular Cron</span></h4>
                        <p>Standard frequency product repricing jobs</p>
                        <ul>
                            <li>Processes products at configured intervals</li>
                            <li>Uses <code>sp_GetActiveFullProductDetailsListByCronV3</code></li>
                            <li>Supports priority-based execution</li>
                            <li>Tracks completion status</li>
                        </ul>
                    </div>
                    <div class="card">
                        <h4><span class="badge badge-cron">Slow Cron</span></h4>
                        <p>Lower frequency cron jobs for less critical products</p>
                        <ul>
                            <li>Reduced execution frequency</li>
                            <li>Uses <code>sp_GetActiveFullProductDetailsListBySlowCronV3</code></li>
                            <li>Optimizes resource utilization</li>
                            <li>Separate settings collection</li>
                        </ul>
                    </div>
                    <div class="card">
                        <h4><span class="badge badge-cron">Scrape Cron</span></h4>
                        <p>Web scraping for competitor data collection</p>
                        <ul>
                            <li>Collects marketplace intelligence</li>
                            <li>Updates competitor pricing</li>
                            <li>Proxy rotation support</li>
                            <li>Scraping provider integration</li>
                        </ul>
                    </div>
                    <div class="card">
                        <h4><span class="badge badge-cron">Filter Cron</span></h4>
                        <p>Product filtering based on eligibility criteria</p>
                        <ul>
                            <li>Filters by update date</li>
                            <li>Uses <code>sp_GetFilterEligibleProductsByFilterDateV3</code></li>
                            <li>Manages product lifecycle</li>
                            <li>Schedules next execution</li>
                        </ul>
                    </div>
                    <div class="card">
                        <h4><span class="badge badge-cron">422 Error Cron</span></h4>
                        <p>Handles 422 validation errors from Net32 API</p>
                        <ul>
                            <li>Retry failed price updates</li>
                            <li>Error-specific handling</li>
                            <li>Separate logging collection</li>
                        </ul>
                    </div>
                    <div class="card">
                        <h4><span class="badge badge-cron">Proxy Switch Cron</span></h4>
                        <p>Manages proxy rotation and health</p>
                        <ul>
                            <li>Monitors proxy performance</li>
                            <li>Automatic failover</li>
                            <li>Periodic reset operations</li>
                        </ul>
                    </div>
                </div>

                <h3>Cron Configuration</h3>
                <p>Cron jobs are configured through MongoDB documents in the <code>cronSettings</code> collection:</p>
                <pre><code>{
  "cronId": "unique-cron-identifier",
  "cronName": "Vendor Product Cron",
  "schedule": "*/15 * * * *",  // Every 15 minutes
  "enabled": true,
  "vendorId": "17357",
  "requestInterval": 2000,      // ms between products
  "priority": 1,
  "lastRun": ISODate,
  "nextRun": ISODate
}</code></pre>

                <h3>Startup Behavior</h3>
                <div class="info-box">
                    When <code>SCHEDULE_CRONS_ON_STARTUP=true</code>, the application automatically starts all enabled cron jobs:
                    <ol>
                        <li>All regular crons via <code>startAllCronLogic()</code></li>
                        <li>422 error handler via <code>start422Logic()</code></li>
                        <li>Filter cron via <code>startFilterCronLogic()</code></li>
                        <li>Slow cron group via <code>startSlowCronLogic()</code></li>
                        <li>Proxy switch cron via <code>startProxySwitchCronLogic()</code></li>
                        <li>Proxy reset cron via <code>startProxySwitchResetCronLogic()</code></li>
                        <li>Scrape cron via <code>startScrapeCronLogic()</code></li>
                        <li>V2 HTML cleanup via <code>startV2AlgoHtmlFileCleanupCron()</code></li>
                    </ol>
                </div>

                <h3>Execution Flow</h3>
                <ol>
                    <li>Cron scheduler triggers based on schedule expression</li>
                    <li>Load product list from database (MySQL stored procedure)</li>
                    <li>Initialize cron status log (MongoDB)</li>
                    <li>Iterate through products with configured delay</li>
                    <li>Execute repricing algorithm for each product</li>
                    <li>Update prices via Net32 API if changes needed</li>
                    <li>Log results to history (MongoDB + MySQL)</li>
                    <li>Update cron completion status</li>
                    <li>Schedule next execution</li>
                </ol>
            </section>

            <!-- DATA MODELS -->
            <section id="data-models">
                <h2>Data Models & Types</h2>

                <h3>Core Product Model - FullProductDetailsV2</h3>
                <p>Comprehensive product information combining repricing settings and operational data:</p>
                <table>
                    <thead>
                        <tr>
                            <th>Field</th>
                            <th>Type</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>ProductIdentifier</td>
                            <td>number</td>
                            <td>Unique database identifier</td>
                        </tr>
                        <tr>
                            <td>ProductId</td>
                            <td>number</td>
                            <td>Net32 MPID (Master Product ID)</td>
                        </tr>
                        <tr>
                            <td>ProductName</td>
                            <td>string</td>
                            <td>Product display name</td>
                        </tr>
                        <tr>
                            <td>Net32Url</td>
                            <td>string</td>
                            <td>Product page URL on Net32</td>
                        </tr>
                        <tr>
                            <td>ChannelName</td>
                            <td>string</td>
                            <td>Vendor name (Tradent, Frontier, etc.)</td>
                        </tr>
                        <tr>
                            <td>ChannelId</td>
                            <td>string</td>
                            <td>Vendor identifier</td>
                        </tr>
                        <tr>
                            <td>Activated</td>
                            <td>number</td>
                            <td>Product active status (1=active, 0=inactive)</td>
                        </tr>
                        <tr>
                            <td>AllowReprice</td>
                            <td>number</td>
                            <td>Repricing permission flag</td>
                        </tr>
                        <tr>
                            <td>UnitPrice</td>
                            <td>string</td>
                            <td>Current unit price</td>
                        </tr>
                        <tr>
                            <td>FloorPrice</td>
                            <td>string</td>
                            <td>Minimum allowed price</td>
                        </tr>
                        <tr>
                            <td>MaxPrice</td>
                            <td>string</td>
                            <td>Maximum allowed price</td>
                        </tr>
                        <tr>
                            <td>RequestInterval</td>
                            <td>number</td>
                            <td>Delay between repricing (ms or minutes)</td>
                        </tr>
                        <tr>
                            <td>RequestIntervalUnit</td>
                            <td>string</td>
                            <td>Unit for interval (milliseconds/minutes)</td>
                        </tr>
                        <tr>
                            <td>RepricingRule</td>
                            <td>number</td>
                            <td>Algorithm version (1=V1, 2=V2)</td>
                        </tr>
                        <tr>
                            <td>CompeteAll</td>
                            <td>number</td>
                            <td>Compete with all vendors (1) or exclude sisters (0)</td>
                        </tr>
                        <tr>
                            <td>BeatQPrice</td>
                            <td>number</td>
                            <td>Beat quantity 1 price flag</td>
                        </tr>
                        <tr>
                            <td>CompareWithQ1</td>
                            <td>number</td>
                            <td>Compare with quantity 1 pricing</td>
                        </tr>
                        <tr>
                            <td>PercentageIncrease</td>
                            <td>number</td>
                            <td>Percentage increase for max pricing</td>
                        </tr>
                        <tr>
                            <td>SuppressPriceBreak</td>
                            <td>number</td>
                            <td>Disable quantity breaks</td>
                        </tr>
                        <tr>
                            <td>SuppressPriceBreakForOne</td>
                            <td>number</td>
                            <td>Suppress breaks for quantity 1</td>
                        </tr>
                        <tr>
                            <td>IsBadgeItem</td>
                            <td>number</td>
                            <td>Vendor badge status</td>
                        </tr>
                        <tr>
                            <td>IsNCNeeded</td>
                            <td>number</td>
                            <td>Non-compete flag</td>
                        </tr>
                        <tr>
                            <td>PriorityValue</td>
                            <td>number</td>
                            <td>Execution priority (higher = sooner)</td>
                        </tr>
                        <tr>
                            <td>RegularCronName</td>
                            <td>string</td>
                            <td>Associated regular cron job name</td>
                        </tr>
                        <tr>
                            <td>RegularCronId</td>
                            <td>string</td>
                            <td>Regular cron job identifier</td>
                        </tr>
                        <tr>
                            <td>SlowCronName</td>
                            <td>string</td>
                            <td>Associated slow cron job name</td>
                        </tr>
                        <tr>
                            <td>SlowCronId</td>
                            <td>string</td>
                            <td>Slow cron job identifier</td>
                        </tr>
                        <tr>
                            <td>IsSlowActivated</td>
                            <td>number</td>
                            <td>Slow cron active flag</td>
                        </tr>
                        <tr>
                            <td>LastCronTime</td>
                            <td>string</td>
                            <td>Timestamp of last cron execution</td>
                        </tr>
                        <tr>
                            <td>LastCronRun</td>
                            <td>string</td>
                            <td>Last cron run details</td>
                        </tr>
                        <tr>
                            <td>NextCronTime</td>
                            <td>string</td>
                            <td>Scheduled next execution time</td>
                        </tr>
                        <tr>
                            <td>LastUpdateTime</td>
                            <td>string</td>
                            <td>Last price update timestamp</td>
                        </tr>
                        <tr>
                            <td>LastAttemptedTime</td>
                            <td>string</td>
                            <td>Last reprice attempt timestamp</td>
                        </tr>
                        <tr>
                            <td>LastCronMessage</td>
                            <td>string</td>
                            <td>Message from last cron execution</td>
                        </tr>
                        <tr>
                            <td>LastExistingPrice</td>
                            <td>string</td>
                            <td>Previous confirmed price</td>
                        </tr>
                        <tr>
                            <td>LastSuggestedPrice</td>
                            <td>string</td>
                            <td>Last algorithm suggestion</td>
                        </tr>
                        <tr>
                            <td>LowestVendor</td>
                            <td>string</td>
                            <td>Vendor with lowest price</td>
                        </tr>
                        <tr>
                            <td>LowestVendorPrice</td>
                            <td>string</td>
                            <td>Lowest competitor price</td>
                        </tr>
                    </tbody>
                </table>

                <h3>Repricing Response Models</h3>
                <div class="grid-2">
                    <div class="card">
                        <h4>RepriceModel</h4>
                        <p>Core repricing result structure:</p>
                        <ul>
                            <li>mpid - Product identifier</li>
                            <li>vendorId - Vendor identifier</li>
                            <li>vendorName - Vendor display name</li>
                            <li>productName - Product name</li>
                            <li>unitPrice - Current unit price</li>
                            <li>suggestedPrice - Algorithm recommendation</li>
                            <li>message - Decision explanation</li>
                            <li>inStock - Stock availability</li>
                            <li>priceUpdated - Update status flag</li>
                        </ul>
                    </div>
                    <div class="card">
                        <h4>RepriceAsyncResponse</h4>
                        <p>Async repricing operation response</p>
                        <ul>
                            <li>success - Operation success flag</li>
                            <li>mpid - Product identifier</li>
                            <li>existingPrice - Pre-reprice price</li>
                            <li>suggestedPrice - New price</li>
                            <li>message - Status message</li>
                            <li>timestamp - Operation time</li>
                        </ul>
                    </div>
                </div>

                <h3>SQL Models</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Model</th>
                            <th>Table</th>
                            <th>Purpose</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>RunInfo</td>
                            <td>table_runInfo</td>
                            <td>Track algorithm execution runs</td>
                        </tr>
                        <tr>
                            <td>ProductInfo</td>
                            <td>table_productInfo</td>
                            <td>Product master data</td>
                        </tr>
                        <tr>
                            <td>PriceBreakInfo</td>
                            <td>table_priceBreaks</td>
                            <td>Quantity-based pricing tiers</td>
                        </tr>
                        <tr>
                            <td>RunCompletionStatus</td>
                            <td>table_runCompletionStatus</td>
                            <td>Run completion tracking</td>
                        </tr>
                        <tr>
                            <td>History</td>
                            <td>table_history</td>
                            <td>Historical repricing records</td>
                        </tr>
                        <tr>
                            <td>HistoryApiResponse</td>
                            <td>table_history_apiResponse</td>
                            <td>API response history</td>
                        </tr>
                    </tbody>
                </table>

                <h3>MongoDB Collections</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Collection</th>
                            <th>Purpose</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>items</td>
                            <td>Product price list data</td>
                        </tr>
                        <tr>
                            <td>cronLogs</td>
                            <td>Cron execution logs</td>
                        </tr>
                        <tr>
                            <td>cronStatusLogs</td>
                            <td>Cron status tracking</td>
                        </tr>
                        <tr>
                            <td>cronSettings</td>
                            <td>Cron job configuration</td>
                        </tr>
                        <tr>
                            <td>slowCronSettings</td>
                            <td>Slow cron configuration</td>
                        </tr>
                        <tr>
                            <td>scrapeCronSettings</td>
                            <td>Scraping cron configuration</td>
                        </tr>
                        <tr>
                            <td>filterCronSettings</td>
                            <td>Filter cron configuration</td>
                        </tr>
                        <tr>
                            <td>errorItems</td>
                            <td>Error tracking and logging</td>
                        </tr>
                        <tr>
                            <td>historyData</td>
                            <td>Historical repricing data</td>
                        </tr>
                        <tr>
                            <td>envsettings</td>
                            <td>Environment-specific settings</td>
                        </tr>
                        <tr>
                            <td>ipConfig</td>
                            <td>Proxy IP configuration</td>
                        </tr>
                        <tr>
                            <td>proxyFailureDetails</td>
                            <td>Proxy failure tracking</td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <!-- DATABASE -->
            <section id="database">
                <h2>Database Integration</h2>

                <h3>MongoDB Operations</h3>
                <p>Primary operational database for configuration and logging.</p>

                <div class="card">
                    <h4>Connection Configuration</h4>
                    <pre><code>MANAGED_MONGO_URL=mongodb://host:port
MANAGED_MONGO_PASSWORD=<password>
GET_PRICE_LIST_DBNAME=repricer</code></pre>
                </div>

                <h4>Key MongoDB Functions</h4>
                <table>
                    <thead>
                        <tr>
                            <th>Function</th>
                            <th>Purpose</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>GetCronSettingsList()</td>
                            <td>Retrieve all cron configurations</td>
                        </tr>
                        <tr>
                            <td>GetCronSettingsDetailsByName()</td>
                            <td>Get specific cron settings</td>
                        </tr>
                        <tr>
                            <td>UpdateCronSettings()</td>
                            <td>Modify cron configuration</td>
                        </tr>
                        <tr>
                            <td>InitCronStatusAsync()</td>
                            <td>Initialize cron status log</td>
                        </tr>
                        <tr>
                            <td>UpdateCronStatusAsync()</td>
                            <td>Update cron execution status</td>
                        </tr>
                        <tr>
                            <td>PushLogsAsync()</td>
                            <td>Add execution logs</td>
                        </tr>
                        <tr>
                            <td>GetGlobalConfig()</td>
                            <td>Retrieve global configuration</td>
                        </tr>
                        <tr>
                            <td>GetItemListById()</td>
                            <td>Get product items by ID</td>
                        </tr>
                        <tr>
                            <td>UpsertHistoryDetails()</td>
                            <td>Insert/update history records</td>
                        </tr>
                        <tr>
                            <td>UpsertErrorItemLog()</td>
                            <td>Log error items</td>
                        </tr>
                    </tbody>
                </table>

                <h3>MySQL Operations</h3>
                <p>Product master data, pricing history, and run tracking.</p>

                <div class="card">
                    <h4>Connection Configuration</h4>
                    <pre><code>SQL_HOSTNAME=mysql-host
SQL_PORT=3306
SQL_USERNAME=<username>
SQL_PASSWORD=<password>
SQL_DATABASE=<database></code></pre>
                </div>

                <h4>Stored Procedures</h4>
                <table>
                    <thead>
                        <tr>
                            <th>Procedure</th>
                            <th>Purpose</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>sp_GetActiveFullProductDetailsListByCronV3</td>
                            <td>Fetch regular cron products</td>
                        </tr>
                        <tr>
                            <td>sp_GetActiveFullProductDetailsListBySlowCronV3</td>
                            <td>Fetch slow cron products</td>
                        </tr>
                        <tr>
                            <td>sp_GetFullProductDetailsByIdV3</td>
                            <td>Get product by ID</td>
                        </tr>
                        <tr>
                            <td>sp_GetFilterEligibleProductsByFilterDateV3</td>
                            <td>Get filter-eligible products</td>
                        </tr>
                        <tr>
                            <td>sp_GetActiveScrapeProductDetailsByCron</td>
                            <td>Fetch scrape products</td>
                        </tr>
                        <tr>
                            <td>sp_GetProductDetailsByCronAndId</td>
                            <td>Get product by cron and ID</td>
                        </tr>
                    </tbody>
                </table>

                <h4>Key MySQL Functions</h4>
                <table>
                    <thead>
                        <tr>
                            <th>Function</th>
                            <th>Purpose</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>GetActiveFullProductDetailsList()</td>
                            <td>Execute product list stored procedure</td>
                        </tr>
                        <tr>
                            <td>InsertRunInfo()</td>
                            <td>Create algorithm run record</td>
                        </tr>
                        <tr>
                            <td>InsertProductInfo()</td>
                            <td>Insert product details</td>
                        </tr>
                        <tr>
                            <td>InsertPriceBreakInfo()</td>
                            <td>Insert quantity breaks</td>
                        </tr>
                        <tr>
                            <td>InsertHistory()</td>
                            <td>Record repricing history</td>
                        </tr>
                        <tr>
                            <td>UpdateProductAsync()</td>
                            <td>Update product data</td>
                        </tr>
                        <tr>
                            <td>UpdateRunCompletionStatus()</td>
                            <td>Mark run completion</td>
                        </tr>
                        <tr>
                            <td>UpdateHistoryWithMessage()</td>
                            <td>Add message to history</td>
                        </tr>
                    </tbody>
                </table>

                <h3>Redis Caching</h3>
                <div class="card">
                    <h4>Cache Strategy</h4>
                    <p>Redis is used for performance optimization with node-cache as fallback.</p>
                    <ul>
                        <li>Product data caching</li>
                        <li>API response caching</li>
                        <li>Configuration caching</li>
                        <li>Vendor data caching</li>
                    </ul>
                    <p><strong>Cache Helpers:</strong> <code>src/utility/cache-helper.ts</code>, <code>src/client/cacheClient.ts</code></p>
                </div>
            </section>

            <!-- CONFIGURATION -->
            <section id="configuration">
                <h2>Configuration & Environment</h2>

                <h3>Environment Variables</h3>
                <p>Comprehensive configuration through environment variables validated with Zod schema.</p>

                <h4>Database Configuration</h4>
                <pre><code># MongoDB
MANAGED_MONGO_URL=mongodb://host:port
MANAGED_MONGO_PASSWORD=password
GET_PRICE_LIST_DBNAME=repricer
GET_PRICE_LIST_COLLECTION_NAME=items

# MySQL
SQL_HOSTNAME=mysql-host
SQL_PORT=3306
SQL_USERNAME=username
SQL_PASSWORD=password
SQL_DATABASE=database</code></pre>

                <h4>Application Settings</h4>
                <pre><code># Server
PORT=5001
IS_DEBUG=false
REQUEST_LOGGING=true

# Repricing
OFFSET=0.01
IGNORE_TIE=false
FLAG_MULTI_PRICE_UPDATE=true
DEFAULT_DELAY=1500

# Cron
SCHEDULE_CRONS_ON_STARTUP=true

# Features
WRITE_HISTORY_SQL=true
FORMAT_RESPONSE_CUSTOM=true</code></pre>

                <h4>Proxy Configuration</h4>
                <pre><code># BrightData
BRIGHTDATA_PROXY_URL=proxy-url
BRIGHTDATA_USERNAME=username
BRIGHTDATA_PASSWORD=password

# ScrapFly
SCRAPFLY_API_KEY=api-key

# ScrapingBee
SCRAPINGBEE_API_KEY=api-key</code></pre>

                <h3>Vendor Mapping</h3>
                <p>Located in <code>src/resources/api-mapping.ts</code></p>
                <table>
                    <thead>
                        <tr>
                            <th>Vendor</th>
                            <th>Vendor ID</th>
                            <th>API URL</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>TRADENT</td>
                            <td>17357</td>
                            <td>http://159.203.57.169:3000</td>
                        </tr>
                        <tr>
                            <td>FRONTIER</td>
                            <td>20722</td>
                            <td>http://142.93.159.114:3000</td>
                        </tr>
                        <tr>
                            <td>MVP</td>
                            <td>20755</td>
                            <td>http://157.230.58.34:3000</td>
                        </tr>
                        <tr>
                            <td>FIRSTDENT</td>
                            <td>20533</td>
                            <td>http://157.230.58.34:3000</td>
                        </tr>
                        <tr>
                            <td>TOPDENT</td>
                            <td>20727</td>
                            <td>http://157.230.58.34:3000</td>
                        </tr>
                        <tr>
                            <td>TRIAD</td>
                            <td>5</td>
                            <td>http://157.230.58.34:3000</td>
                        </tr>
                    </tbody>
                </table>

                <h3>Global Configuration Management</h3>
                <div class="card">
                    <h4>GlobalConfig Interface</h4>
                    <p>Runtime configuration stored in MongoDB <code>envsettings</code> collection:</p>
                    <ul>
                        <li>AuditInfo - Tracking metadata (createdAt, updatedAt, updatedBy)</li>
                        <li>PrioritySettings - Execution priority configuration</li>
                        <li>OverrideExecutionPriorityDetails - Priority override rules</li>
                    </ul>
                    <p><strong>Access:</strong> <code>GetGlobalConfig()</code> from <code>mongo-helper.ts</code></p>
                </div>
            </section>

            <!-- UTILITIES -->
            <section id="utilities">
                <h2>Utility Modules</h2>

                <h3>Core Utilities</h3>
                <div class="grid-2">
                    <div class="card">
                        <h4>axios-helper.ts</h4>
                        <p>HTTP request wrapper with retry logic</p>
                        <ul>
                            <li>Axios instance configuration</li>
                            <li>Retry on failure (axios-retry)</li>
                            <li>Sister vendor data fetching</li>
                            <li>Net32 API integration</li>
                        </ul>
                    </div>
                    <div class="card">
                        <h4>cache-helper.ts</h4>
                        <p>Redis and node-cache abstraction</p>
                        <ul>
                            <li>Get/Set operations</li>
                            <li>TTL management</li>
                            <li>Fallback to memory cache</li>
                            <li>Cache invalidation</li>
                        </ul>
                    </div>
                    <div class="card">
                        <h4>feed-helper.ts</h4>
                        <p>Net32 feed processing</p>
                        <ul>
                            <li>XML feed parsing</li>
                            <li>Product context extraction</li>
                            <li>Competitor data parsing</li>
                            <li>Stock availability checks</li>
                        </ul>
                    </div>
                    <div class="card">
                        <h4>history-helper.ts</h4>
                        <p>Historical data management</p>
                        <ul>
                            <li>Reprice history logging</li>
                            <li>Audit trail creation</li>
                            <li>Historical queries</li>
                            <li>Change tracking</li>
                        </ul>
                    </div>
                    <div class="card">
                        <h4>response-utility.ts</h4>
                        <p>Response formatting and validation</p>
                        <ul>
                            <li>Response standardization</li>
                            <li>Eligibility checks</li>
                            <li>Price validation</li>
                            <li>Error handling</li>
                        </ul>
                    </div>
                    <div class="card">
                        <h4>error-middleware.ts</h4>
                        <p>Global error handling</p>
                        <ul>
                            <li>Catch unhandled errors</li>
                            <li>Format error responses</li>
                            <li>Log error details</li>
                            <li>HTTP status codes</li>
                        </ul>
                    </div>
                </div>

                <h3>Proxy Management</h3>
                <div class="card">
                    <h4>Proxy Utilities</h4>
                    <p>Located in <code>src/utility/proxy/</code></p>
                    <ul>
                        <li><code>bright-data-helper.ts</code> - BrightData proxy integration</li>
                        <li><code>scrapfly-helper.ts</code> - ScrapFly API integration</li>
                        <li><code>axios-retry-helper.ts</code> - Retry logic for proxies</li>
                    </ul>
                    <p>Also: <code>proxy-helper.ts</code>, <code>proxy-switch-helper.ts</code>, <code>debug-proxy-helper.ts</code></p>
                </div>

                <h3>Net32 Integration</h3>
                <div class="card">
                    <h4>Net32 Utilities</h4>
                    <p>Located in <code>src/utility/net32/</code></p>
                    <ul>
                        <li><code>updateProductQuantity.ts</code> - Quantity update operations</li>
                        <li><code>proxyAxiosInstance.ts</code> - Configured axios with proxy</li>
                    </ul>
                </div>

                <h3>Helper Functions</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Utility</th>
                            <th>Purpose</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>arrays.ts</td>
                            <td>Array manipulation helpers</td>
                        </tr>
                        <tr>
                            <td>encrypto.ts</td>
                            <td>Encryption/decryption utilities</td>
                        </tr>
                        <tr>
                            <td>format-wrapper.ts</td>
                            <td>Data formatting functions</td>
                        </tr>
                        <tr>
                            <td>request-generator.ts</td>
                            <td>Request object generation</td>
                        </tr>
                        <tr>
                            <td>repriceResultParser.ts</td>
                            <td>Parse repricing results</td>
                        </tr>
                        <tr>
                            <td>scrape-helper.ts</td>
                            <td>Web scraping utilities</td>
                        </tr>
                        <tr>
                            <td>buy-box-helper.ts</td>
                            <td>Buy-box logic helpers</td>
                        </tr>
                        <tr>
                            <td>badge-helper.ts</td>
                            <td>Vendor badge utilities</td>
                        </tr>
                        <tr>
                            <td>job-id-helper.ts</td>
                            <td>Job identifier generation</td>
                        </tr>
                        <tr>
                            <td>filter-mapper.ts</td>
                            <td>Filter criteria mapping</td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <!-- DEPLOYMENT -->
            <section id="deployment">
                <h2>Deployment & Operations</h2>

                <h3>Development Setup</h3>
                <pre><code># Install dependencies
npm install

# Set up environment variables
cp .env.example .env
# Edit .env with your configuration

# Run in development mode
npm run dev

# Run tests
npm test

# Format code
npm run format</code></pre>

                <h3>Production Build</h3>
                <pre><code># Build TypeScript
npm run build

# Start production server
npm start

# Output location: dist/main.js</code></pre>

                <h3>Docker Deployment</h3>
                <div class="card">
                    <h4>Dockerfile</h4>
                    <p>Container configuration available in <code>Dockerfile</code></p>
                    <pre><code># Build image
docker build -t api-core:latest .

# Run container
docker run -p 5001:5001 --env-file .env api-core:latest</code></pre>
                </div>

                <h3>Health Monitoring</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Endpoint</th>
                            <th>Purpose</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>GET /health</td>
                            <td>Basic health check (200 OK)</td>
                        </tr>
                        <tr>
                            <td>GET /api/GetStatus</td>
                            <td>Application status with port info</td>
                        </tr>
                    </tbody>
                </table>

                <h3>Logging</h3>
                <div class="card">
                    <h4>Log Configuration</h4>
                    <ul>
                        <li><strong>Morgan:</strong> HTTP request logging (when <code>REQUEST_LOGGING=true</code>)</li>
                        <li><strong>App Logs:</strong> Configured path via <code>APP_LOG_PATH</code></li>
                        <li><strong>Cron Logs:</strong> MongoDB <code>cronLogs</code> collection</li>
                        <li><strong>Error Logs:</strong> MongoDB <code>errorItems</code> collection</li>
                        <li><strong>Console:</strong> Standard Node.js console output</li>
                    </ul>
                </div>

                <h3>Error Handling</h3>
                <div class="info-box">
                    <strong>Global Error Handlers:</strong>
                    <ul>
                        <li><code>uncaughtException</code> - Logs uncaught exceptions</li>
                        <li><code>unhandledRejection</code> - Logs unhandled promise rejections</li>
                        <li><code>errorMiddleware</code> - Express error middleware for HTTP errors</li>
                    </ul>
                </div>

                <h3>Performance Optimization</h3>
                <div class="grid-2">
                    <div class="card">
                        <h4>Compression</h4>
                        <p>Response compression enabled via <code>compression</code> middleware:</p>
                        <ul>
                            <li>Level 9 compression</li>
                            <li>Threshold: 0 bytes (all responses)</li>
                            <li>Opt-out via <code>x-no-compression</code> header</li>
                        </ul>
                    </div>
                    <div class="card">
                        <h4>Caching</h4>
                        <p>Multi-layer caching strategy:</p>
                        <ul>
                            <li>Redis for distributed caching</li>
                            <li>node-cache for local memory cache</li>
                            <li>Database query result caching</li>
                            <li>API response caching</li>
                        </ul>
                    </div>
                </div>

                <h3>Security Considerations</h3>
                <div class="highlight-box">
                    <strong>Important Security Notes:</strong>
                    <ul>
                        <li><code>IS_DEV</code> flag controls production vs development endpoints - verify before deployment</li>
                        <li>Environment variables should never be committed to version control</li>
                        <li>Database credentials stored in environment variables only</li>
                        <li>Proxy credentials managed through secure configuration</li>
                        <li>CORS middleware not explicitly configured - consider adding for production</li>
                        <li>Request body size limited to 200kb</li>
                    </ul>
                </div>
            </section>
        </div>

        <footer>
            <p>API-Core Technical Documentation - Version 1.0.2</p>
            <p>Generated on <?php echo date('Y-m-d H:i:s'); ?></p>
            <p style="margin-top: 1rem; font-size: 0.9rem;">For questions or support, contact: pranoyg52@gmail.com</p>
        </footer>
    </div>
</body>
</html>