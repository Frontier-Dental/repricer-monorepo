<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>V1 Repricing Algorithm - Complete Field Guide</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f5f5;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }

        header {
            background: linear-gradient(135deg, #56ab2f 0%, #a8e063 100%);
            color: white;
            padding: 3rem 2rem;
            border-bottom: 4px solid #4a9427;
        }

        header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .meta-info {
            background: rgba(255,255,255,0.1);
            padding: 1rem;
            margin-top: 1.5rem;
            border-radius: 8px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .meta-info div {
            display: flex;
            flex-direction: column;
        }

        .meta-info strong {
            font-size: 0.85rem;
            opacity: 0.8;
            margin-bottom: 0.25rem;
        }

        .meta-info span {
            font-size: 1.1rem;
        }

        nav {
            background: #f8f9fa;
            padding: 1.5rem 2rem;
            border-bottom: 2px solid #e9ecef;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        nav h2 {
            font-size: 0.9rem;
            color: #6c757d;
            margin-bottom: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        nav ul {
            list-style: none;
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        nav a {
            color: #56ab2f;
            text-decoration: none;
            padding: 0.5rem 1rem;
            background: white;
            border-radius: 6px;
            border: 1px solid #e9ecef;
            transition: all 0.3s ease;
        }

        nav a:hover {
            background: #56ab2f;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        main {
            padding: 2rem;
        }

        section {
            margin-bottom: 3rem;
            background: white;
            border-radius: 8px;
            padding: 2rem;
            border: 1px solid #e9ecef;
        }

        h2 {
            color: #2c3e50;
            font-size: 2rem;
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 3px solid #56ab2f;
        }

        h3 {
            color: #34495e;
            font-size: 1.5rem;
            margin-top: 2rem;
            margin-bottom: 1rem;
        }

        h4 {
            color: #495057;
            font-size: 1.2rem;
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
        }

        .field-group {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border-left: 4px solid #56ab2f;
        }

        .field-name {
            font-weight: bold;
            color: #2c3e50;
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .field-type {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            background: #e3f2fd;
            color: #1976d2;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: normal;
        }

        .field-description {
            margin: 1rem 0;
        }

        .field-details {
            display: grid;
            gap: 0.75rem;
            margin-top: 1rem;
        }

        .field-detail {
            display: grid;
            grid-template-columns: 140px 1fr;
            gap: 1rem;
        }

        .field-detail strong {
            color: #6c757d;
            font-weight: 600;
        }

        .strategy-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .strategy-card h3 {
            color: white;
            margin-top: 0;
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
        }

        .strategy-description {
            opacity: 0.95;
            margin-bottom: 1.5rem;
            font-size: 1.1rem;
        }

        .strategy-settings {
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            padding: 1.5rem;
        }

        .setting-row {
            display: grid;
            grid-template-columns: 250px 1fr;
            gap: 1rem;
            padding: 0.5rem 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .setting-row:last-child {
            border-bottom: none;
        }

        .setting-name {
            font-weight: 600;
            opacity: 0.9;
        }

        .setting-value {
            font-family: 'Courier New', monospace;
            background: rgba(255,255,255,0.15);
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
        }

        .alert {
            padding: 1rem 1.5rem;
            border-radius: 8px;
            margin: 1.5rem 0;
        }

        .alert-warning {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            color: #856404;
        }

        .alert-info {
            background: #d1ecf1;
            border-left: 4px solid #17a2b8;
            color: #0c5460;
        }

        .alert-danger {
            background: #f8d7da;
            border-left: 4px solid #dc3545;
            color: #721c24;
        }

        .alert-success {
            background: #d4edda;
            border-left: 4px solid #28a745;
            color: #155724;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
        }

        th {
            background: #56ab2f;
            color: white;
            padding: 1rem;
            text-align: left;
            font-weight: 600;
        }

        td {
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #e9ecef;
        }

        tr:hover {
            background: #f8f9fa;
        }

        .rule-card {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            transition: all 0.3s ease;
        }

        .rule-card:hover {
            border-color: #56ab2f;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .rule-number {
            display: inline-block;
            width: 30px;
            height: 30px;
            background: #56ab2f;
            color: white;
            text-align: center;
            line-height: 30px;
            border-radius: 50%;
            margin-right: 0.5rem;
            font-weight: bold;
        }

        .rule-name {
            font-size: 1.2rem;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 0.5rem;
        }

        .rule-description {
            color: #6c757d;
            margin-bottom: 1rem;
        }

        .rule-example {
            background: #f8f9fa;
            padding: 1rem;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            color: #495057;
        }

        .dependency-diagram {
            background: #f8f9fa;
            border: 2px dashed #dee2e6;
            border-radius: 8px;
            padding: 2rem;
            margin: 2rem 0;
            text-align: center;
        }

        .dependency-row {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 1rem 0;
            gap: 2rem;
        }

        .dependency-field {
            background: white;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            border: 2px solid #56ab2f;
            font-weight: 600;
            color: #2c3e50;
        }

        .dependency-arrow {
            color: #6c757d;
            font-size: 1.5rem;
        }

        .troubleshooting-item {
            background: white;
            border-left: 4px solid #dc3545;
            padding: 1.5rem;
            margin-bottom: 1rem;
            border-radius: 0 8px 8px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .problem {
            font-weight: 600;
            color: #dc3545;
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
        }

        .solution {
            color: #28a745;
            margin-top: 0.5rem;
        }

        .comparison-table {
            overflow-x: auto;
        }

        .comparison-table table {
            min-width: 600px;
        }

        .comparison-table th:first-child,
        .comparison-table td:first-child {
            position: sticky;
            left: 0;
            background: white;
            z-index: 10;
        }

        .comparison-table th:first-child {
            background: #56ab2f;
        }

        .feature-yes {
            color: #28a745;
            font-weight: 600;
        }

        .feature-no {
            color: #dc3545;
            font-weight: 600;
        }

        .feature-partial {
            color: #ffc107;
            font-weight: 600;
        }

        footer {
            background: #2c3e50;
            color: white;
            padding: 2rem;
            text-align: center;
        }

        footer a {
            color: #56ab2f;
            text-decoration: none;
        }

        footer a:hover {
            text-decoration: underline;
        }

        .code-example {
            background: #2c3e50;
            color: #f8f9fa;
            padding: 1rem;
            border-radius: 6px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            margin: 1rem 0;
        }

        .badge-strategy {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            color: #856404;
            border-radius: 4px;
            font-weight: 600;
            margin: 0 0.25rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üöÄ V1 Repricing Algorithm - Complete Field Guide</h1>
            <p>Master the legacy repricing system with this comprehensive business user guide</p>
            <div class="meta-info">
                <div>
                    <strong>Version</strong>
                    <span>V1 Legacy</span>
                </div>
                <div>
                    <strong>Architecture</strong>
                    <span>Rules-Based System</span>
                </div>
                <div>
                    <strong>Configuration Fields</strong>
                    <span>24 Settings</span>
                </div>
                <div>
                    <strong>Business Rules</strong>
                    <span>12+ Rules</span>
                </div>
                <div>
                    <strong>Total Code</strong>
                    <span>5,103 Lines</span>
                </div>
                <div>
                    <strong>Last Updated</strong>
                    <span>November 2024</span>
                </div>
            </div>
        </header>

        <nav>
            <h2>Quick Navigation</h2>
            <ul>
                <li><a href="#introduction">Introduction</a></li>
                <li><a href="#quick-start">Quick Start</a></li>
                <li><a href="#core-settings">Core Settings</a></li>
                <li><a href="#business-rules">Business Rules</a></li>
                <li><a href="#nc-mode">NC Mode</a></li>
                <li><a href="#advanced">Advanced Strategies</a></li>
                <li><a href="#dependencies">Field Dependencies</a></li>
                <li><a href="#mistakes">Common Mistakes</a></li>
                <li><a href="#troubleshooting">Troubleshooting</a></li>
                <li><a href="#comparison">V1 vs V2</a></li>
            </ul>
        </nav>

        <main>
            <section id="introduction">
                <h2>üìö Introduction to V1 Algorithm</h2>

                <h3>What is the V1 Algorithm?</h3>
                <p>The V1 algorithm is the <strong>original repricing engine</strong> that uses a rules-based approach to determine competitive prices. Unlike the newer V2 algorithm which uses database-driven settings, V1 applies business rules programmatically through a sophisticated rule engine.</p>

                <div class="alert alert-info">
                    <strong>Key Architecture:</strong> The V1 system processes pricing through 5 core files:
                    <ul style="margin-top: 0.5rem; margin-left: 1.5rem;">
                        <li><strong>algo-v1.ts</strong> - Orchestrates the entire repricing process</li>
                        <li><strong>reprice-helper.ts</strong> - Standard unit price calculations</li>
                        <li><strong>reprice-helper-nc.ts</strong> - NC mode (shipping-inclusive) pricing</li>
                        <li><strong>repricer-rule-helper.ts</strong> - Applies 12+ business rules</li>
                        <li><strong>shared.ts</strong> - Common utilities and helpers</li>
                    </ul>
                </div>

                <h3>When to Use V1 vs V2?</h3>
                <table>
                    <tr>
                        <th>Use V1 When:</th>
                        <th>Use V2 When:</th>
                    </tr>
                    <tr>
                        <td>‚Ä¢ Product has simple pricing requirements</td>
                        <td>‚Ä¢ Need advanced badge competition strategies</td>
                    </tr>
                    <tr>
                        <td>‚Ä¢ Already configured and working well</td>
                        <td>‚Ä¢ Require buy-box optimization</td>
                    </tr>
                    <tr>
                        <td>‚Ä¢ Need quick rule-based adjustments</td>
                        <td>‚Ä¢ Want price strategy options (UNIT/TOTAL/BUY_BOX)</td>
                    </tr>
                    <tr>
                        <td>‚Ä¢ Prefer simpler configuration (~24 fields)</td>
                        <td>‚Ä¢ Need detailed execution priority control</td>
                    </tr>
                    <tr>
                        <td>‚Ä¢ Have legacy integration dependencies</td>
                        <td>‚Ä¢ Want comprehensive algorithm settings (27 fields)</td>
                    </tr>
                </table>

                <h3>Key Differences from V2</h3>
                <div class="alert alert-warning">
                    <strong>Important:</strong> V1 uses a fundamentally different approach than V2:
                    <ul style="margin-top: 0.5rem; margin-left: 1.5rem;">
                        <li>V1 has ~24 configuration settings vs V2's 27 fields</li>
                        <li>V1 applies rules sequentially vs V2's database-driven approach</li>
                        <li>V1 has basic badge filtering vs V2's 4 badge strategies</li>
                        <li>V1 supports UNIT pricing only vs V2's UNIT/TOTAL/BUY_BOX strategies</li>
                        <li>V1 uses programmatic rules vs V2's configurable settings table</li>
                    </ul>
                </div>
            </section>

            <section id="quick-start">
                <h2>üöÄ Quick Start Guide</h2>
                <p>Get started quickly with these three pre-configured strategies. Copy these settings to implement common repricing scenarios.</p>

                <div class="strategy-card" style="background: linear-gradient(135deg, #667eea, #764ba2);">
                    <h3>üõ°Ô∏è Conservative Strategy</h3>
                    <p class="strategy-description">Protect margins while staying competitive. Only increase prices, never decrease below current levels.</p>
                    <div class="strategy-settings">
                        <div class="setting-row">
                            <span class="setting-name">repricingRule</span>
                            <span class="setting-value">0 (Up Only)</span>
                        </div>
                        <div class="setting-row">
                            <span class="setting-name">floorPrice</span>
                            <span class="setting-value">15.00</span>
                        </div>
                        <div class="setting-row">
                            <span class="setting-name">maxPrice</span>
                            <span class="setting-value">50.00</span>
                        </div>
                        <div class="setting-row">
                            <span class="setting-name">percentageIncrease</span>
                            <span class="setting-value">10</span>
                        </div>
                        <div class="setting-row">
                            <span class="setting-name">suppressPriceBreak</span>
                            <span class="setting-value">true</span>
                        </div>
                        <div class="setting-row">
                            <span class="setting-name">applyBuyBoxLogic</span>
                            <span class="setting-value">true</span>
                        </div>
                        <div class="setting-row">
                            <span class="setting-name">keepPosition</span>
                            <span class="setting-value">true</span>
                        </div>
                        <div class="setting-row">
                            <span class="setting-name">competeAll</span>
                            <span class="setting-value">false</span>
                        </div>
                        <div class="setting-row">
                            <span class="setting-name">badgeIndicator</span>
                            <span class="setting-value">BADGE_ONLY</span>
                        </div>
                    </div>
                </div>

                <div class="strategy-card" style="background: linear-gradient(135deg, #56ab2f, #a8e063);">
                    <h3>‚öñÔ∏è Balanced Strategy</h3>
                    <p class="strategy-description">Maintain competitive position with moderate adjustments in both directions.</p>
                    <div class="strategy-settings">
                        <div class="setting-row">
                            <span class="setting-name">repricingRule</span>
                            <span class="setting-value">2 (Both)</span>
                        </div>
                        <div class="setting-row">
                            <span class="setting-name">floorPrice</span>
                            <span class="setting-value">10.00</span>
                        </div>
                        <div class="setting-row">
                            <span class="setting-name">maxPrice</span>
                            <span class="setting-value">75.00</span>
                        </div>
                        <div class="setting-row">
                            <span class="setting-name">percentageIncrease</span>
                            <span class="setting-value">15</span>
                        </div>
                        <div class="setting-row">
                            <span class="setting-name">percentageDown</span>
                            <span class="setting-value">10</span>
                        </div>
                        <div class="setting-row">
                            <span class="setting-name">suppressPriceBreak</span>
                            <span class="setting-value">false</span>
                        </div>
                        <div class="setting-row">
                            <span class="setting-name">compareWithQ1</span>
                            <span class="setting-value">true</span>
                        </div>
                        <div class="setting-row">
                            <span class="setting-name">competeAll</span>
                            <span class="setting-value">false</span>
                        </div>
                        <div class="setting-row">
                            <span class="setting-name">badgeIndicator</span>
                            <span class="setting-value">ALL</span>
                        </div>
                    </div>
                </div>

                <div class="strategy-card" style="background: linear-gradient(135deg, #fc466b, #3f5efb);">
                    <h3>üéØ Aggressive Strategy</h3>
                    <p class="strategy-description">Win the buy box aggressively with lower prices and rapid adjustments.</p>
                    <div class="strategy-settings">
                        <div class="setting-row">
                            <span class="setting-name">repricingRule</span>
                            <span class="setting-value">1 (Down Only)</span>
                        </div>
                        <div class="setting-row">
                            <span class="setting-name">floorPrice</span>
                            <span class="setting-value">5.00</span>
                        </div>
                        <div class="setting-row">
                            <span class="setting-name">maxPrice</span>
                            <span class="setting-value">100.00</span>
                        </div>
                        <div class="setting-row">
                            <span class="setting-name">percentageDown</span>
                            <span class="setting-value">20</span>
                        </div>
                        <div class="setting-row">
                            <span class="setting-name">badgePercentageDown</span>
                            <span class="setting-value">15</span>
                        </div>
                        <div class="setting-row">
                            <span class="setting-name">is_nc_needed</span>
                            <span class="setting-value">true</span>
                        </div>
                        <div class="setting-row">
                            <span class="setting-name">applyNcForBuyBox</span>
                            <span class="setting-value">true</span>
                        </div>
                        <div class="setting-row">
                            <span class="setting-name">competeAll</span>
                            <span class="setting-value">true</span>
                        </div>
                        <div class="setting-row">
                            <span class="setting-name">competeWithNext</span>
                            <span class="setting-value">true</span>
                        </div>
                    </div>
                </div>
            </section>

            <section id="core-settings">
                <h2>‚öôÔ∏è Core Algorithm Settings</h2>
                <p>These 24 configuration fields control how the V1 algorithm makes pricing decisions. Each field serves a specific purpose in the repricing logic.</p>

                <h3>üí∞ Price Limits</h3>

                <div class="field-group">
                    <div class="field-name">
                        floorPrice <span class="field-type">text value (decimal)</span>
                    </div>
                    <div class="field-description">
                        The absolute minimum price the algorithm will ever set. This is your profitability protection.
                    </div>
                    <div class="field-details">
                        <div class="field-detail">
                            <strong>What it does:</strong>
                            <span>Creates a hard floor below which prices cannot drop, even if competitors are lower</span>
                        </div>
                        <div class="field-detail">
                            <strong>When to use:</strong>
                            <span>Always set this to your minimum profitable price including all costs</span>
                        </div>
                        <div class="field-detail">
                            <strong>Common values:</strong>
                            <span>"5.00", "10.00", "15.50" (your cost + minimum margin)</span>
                        </div>
                        <div class="field-detail">
                            <strong>Important note:</strong>
                            <span>‚ö†Ô∏è Algorithm will stop competing rather than go below this price</span>
                        </div>
                    </div>
                </div>

                <div class="field-group">
                    <div class="field-name">
                        maxPrice <span class="field-type">text value (decimal)</span>
                    </div>
                    <div class="field-description">
                        The maximum price ceiling the algorithm will set. Prevents unrealistic price increases.
                    </div>
                    <div class="field-details">
                        <div class="field-detail">
                            <strong>What it does:</strong>
                            <span>Creates a ceiling to prevent prices from rising too high when there's no competition</span>
                        </div>
                        <div class="field-detail">
                            <strong>When to use:</strong>
                            <span>Set to a reasonable market maximum or MSRP to maintain customer trust</span>
                        </div>
                        <div class="field-detail">
                            <strong>Common values:</strong>
                            <span>"50.00", "100.00", "999.99" (market maximum or MSRP)</span>
                        </div>
                        <div class="field-detail">
                            <strong>Important note:</strong>
                            <span>Prevents price gouging when you're the only seller</span>
                        </div>
                    </div>
                </div>

                <h3>üéØ Pricing Direction</h3>

                <div class="field-group">
                    <div class="field-name">
                        repricingRule <span class="field-type">number (0, 1, or 2)</span>
                    </div>
                    <div class="field-description">
                        Controls which direction prices can move. This is one of the most important settings.
                    </div>
                    <div class="field-details">
                        <div class="field-detail">
                            <strong>What it does:</strong>
                            <span>Determines if prices can increase, decrease, or both</span>
                        </div>
                        <div class="field-detail">
                            <strong>Options:</strong>
                            <span>
                                ‚Ä¢ <strong>0 (Up Only)</strong> - Only increase prices, never decrease<br>
                                ‚Ä¢ <strong>1 (Down Only)</strong> - Only decrease prices, never increase<br>
                                ‚Ä¢ <strong>2 (Both)</strong> - Allow both increases and decreases
                            </span>
                        </div>
                        <div class="field-detail">
                            <strong>When to use:</strong>
                            <span>
                                ‚Ä¢ Use 0 for margin protection during inflation<br>
                                ‚Ä¢ Use 1 for aggressive market share capture<br>
                                ‚Ä¢ Use 2 for dynamic competitive positioning
                            </span>
                        </div>
                        <div class="field-detail">
                            <strong>Important note:</strong>
                            <span>This rule is applied AFTER price calculation, blocking unwanted directions</span>
                        </div>
                    </div>
                </div>

                <div class="field-group">
                    <div class="field-name">
                        percentageIncrease <span class="field-type">number (percentage)</span>
                    </div>
                    <div class="field-description">
                        Limits how much prices can increase in a single repricing event.
                    </div>
                    <div class="field-details">
                        <div class="field-detail">
                            <strong>What it does:</strong>
                            <span>Caps price increases to prevent shocking customers with sudden jumps</span>
                        </div>
                        <div class="field-detail">
                            <strong>When to use:</strong>
                            <span>Always set this to maintain gradual price changes</span>
                        </div>
                        <div class="field-detail">
                            <strong>Common values:</strong>
                            <span>5, 10, 15, 20 (percentage points)</span>
                        </div>
                        <div class="field-detail">
                            <strong>Example:</strong>
                            <span>If set to 10 and current price is $50, max new price is $55</span>
                        </div>
                    </div>
                </div>

                <div class="field-group">
                    <div class="field-name">
                        percentageDown <span class="field-type">text value (percentage)</span>
                    </div>
                    <div class="field-description">
                        General percentage for downward price adjustments.
                    </div>
                    <div class="field-details">
                        <div class="field-detail">
                            <strong>What it does:</strong>
                            <span>Controls how aggressively to undercut competitors</span>
                        </div>
                        <div class="field-detail">
                            <strong>When to use:</strong>
                            <span>When you want to beat competitors by a specific percentage</span>
                        </div>
                        <div class="field-detail">
                            <strong>Common values:</strong>
                            <span>"5", "10", "15" (percentage to undercut)</span>
                        </div>
                    </div>
                </div>

                <h3>üì¶ Quantity Break Rules</h3>

                <div class="field-group">
                    <div class="field-name">
                        suppressPriceBreak <span class="field-type">toggle (true/false)</span>
                    </div>
                    <div class="field-description">
                        Only update quantity 1 (Q1) prices, leaving all other quantity breaks unchanged.
                    </div>
                    <div class="field-details">
                        <div class="field-detail">
                            <strong>What it does:</strong>
                            <span>Focuses repricing only on single-unit purchases (Q1)</span>
                        </div>
                        <div class="field-detail">
                            <strong>When to use:</strong>
                            <span>When bulk pricing is manually managed or contractually fixed</span>
                        </div>
                        <div class="field-detail">
                            <strong>Common values:</strong>
                            <span>true (Q1 only) or false (all quantities)</span>
                        </div>
                        <div class="field-detail">
                            <strong>Important note:</strong>
                            <span>When true, Q2, Q3, etc. remain at current prices</span>
                        </div>
                    </div>
                </div>

                <div class="field-group">
                    <div class="field-name">
                        compareWithQ1 <span class="field-type">toggle (true/false)</span>
                    </div>
                    <div class="field-description">
                        Ensures quantity 2 (Q2) pricing is competitive compared to Q1.
                    </div>
                    <div class="field-details">
                        <div class="field-detail">
                            <strong>What it does:</strong>
                            <span>Validates that bulk pricing offers real value vs single units</span>
                        </div>
                        <div class="field-detail">
                            <strong>When to use:</strong>
                            <span>When you want to ensure quantity discounts are meaningful</span>
                        </div>
                        <div class="field-detail">
                            <strong>Effect:</strong>
                            <span>Creates Q2 price break if it doesn't exist, ensures Q2 unit price < Q1</span>
                        </div>
                    </div>
                </div>

                <div class="field-group">
                    <div class="field-name">
                        abortDeactivatingQPriceBreak <span class="field-type">toggle (true/false)</span>
                    </div>
                    <div class="field-description">
                        Prevents the algorithm from deactivating quantity price breaks.
                    </div>
                    <div class="field-details">
                        <div class="field-detail">
                            <strong>What it does:</strong>
                            <span>Keeps quantity breaks active even when not competitive</span>
                        </div>
                        <div class="field-detail">
                            <strong>When to use:</strong>
                            <span>When you always want to offer bulk discounts regardless of competition</span>
                        </div>
                        <div class="field-detail">
                            <strong>Common scenario:</strong>
                            <span>Contractual obligations to maintain bulk pricing</span>
                        </div>
                    </div>
                </div>

                <div class="field-group">
                    <div class="field-name">
                        beatQPrice <span class="field-type">toggle (true/false)</span>
                    </div>
                    <div class="field-description">
                        Protects Q1 price from being beaten by higher quantity breaks.
                    </div>
                    <div class="field-details">
                        <div class="field-detail">
                            <strong>What it does:</strong>
                            <span>Ensures Q1 remains the entry price point, not undercut by bulk</span>
                        </div>
                        <div class="field-detail">
                            <strong>When to use:</strong>
                            <span>When Q1 visibility is critical for attracting customers</span>
                        </div>
                        <div class="field-detail">
                            <strong>Effect:</strong>
                            <span>Blocks changes that would make Q2/Q3 per-unit cheaper than Q1</span>
                        </div>
                    </div>
                </div>

                <h3>üè™ Competition Settings</h3>

                <div class="field-group">
                    <div class="field-name">
                        competeAll <span class="field-type">toggle (true/false)</span>
                    </div>
                    <div class="field-description">
                        Determines whether to compete with all vendors or exclude sister companies.
                    </div>
                    <div class="field-details">
                        <div class="field-detail">
                            <strong>What it does:</strong>
                            <span>Controls vendor inclusion in competitive analysis</span>
                        </div>
                        <div class="field-detail">
                            <strong>Options:</strong>
                            <span>
                                ‚Ä¢ <strong>true</strong> - Compete with everyone including sister vendors<br>
                                ‚Ä¢ <strong>false</strong> - Exclude sister vendors from competition
                            </span>
                        </div>
                        <div class="field-detail">
                            <strong>When to use false:</strong>
                            <span>When you have multiple seller accounts and don't want to compete against yourself</span>
                        </div>
                    </div>
                </div>

                <div class="field-group">
                    <div class="field-name">
                        excludedVendors <span class="field-type">text value (semicolon-separated IDs)</span>
                    </div>
                    <div class="field-description">
                        List of vendor IDs to exclude from competition (sister companies).
                    </div>
                    <div class="field-details">
                        <div class="field-detail">
                            <strong>What it does:</strong>
                            <span>Explicitly excludes specific vendors from price competition</span>
                        </div>
                        <div class="field-detail">
                            <strong>Format:</strong>
                            <span>"17357;20722;20755" (semicolon-separated vendor IDs)</span>
                        </div>
                        <div class="field-detail">
                            <strong>Common use:</strong>
                            <span>Excluding your other seller accounts or partner vendors</span>
                        </div>
                        <div class="field-detail">
                            <strong>Works with:</strong>
                            <span>competeAll=false and ApplySisterComparisonCheck rule</span>
                        </div>
                    </div>
                </div>

                <div class="field-group">
                    <div class="field-name">
                        competeWithNext <span class="field-type">toggle (true/false)</span>
                    </div>
                    <div class="field-description">
                        Compete with the next vendor in ranking rather than the lowest.
                    </div>
                    <div class="field-details">
                        <div class="field-detail">
                            <strong>What it does:</strong>
                            <span>Targets the vendor directly below you instead of the lowest price</span>
                        </div>
                        <div class="field-detail">
                            <strong>When to use:</strong>
                            <span>When you want to maintain position without racing to the bottom</span>
                        </div>
                        <div class="field-detail">
                            <strong>Strategy:</strong>
                            <span>More sustainable than always matching the lowest price</span>
                        </div>
                    </div>
                </div>

                <h3>üèÖ Badge Competition</h3>

                <div class="field-group">
                    <div class="field-name">
                        badgeIndicator <span class="field-type">text ("ALL" or "BADGE_ONLY")</span>
                    </div>
                    <div class="field-description">
                        Filter which vendors to compete with based on badge status.
                    </div>
                    <div class="field-details">
                        <div class="field-detail">
                            <strong>Options:</strong>
                            <span>
                                ‚Ä¢ <strong>ALL</strong> - Compete with all vendors regardless of badge<br>
                                ‚Ä¢ <strong>BADGE_ONLY</strong> - Only compete with badge holders
                            </span>
                        </div>
                        <div class="field-detail">
                            <strong>When to use BADGE_ONLY:</strong>
                            <span>When you have a badge and want to stay competitive within badge tier</span>
                        </div>
                        <div class="field-detail">
                            <strong>Effect:</strong>
                            <span>Filters competitor list before price calculation</span>
                        </div>
                    </div>
                </div>

                <div class="field-group">
                    <div class="field-name">
                        badgePercentage <span class="field-type">number (percentage)</span>
                    </div>
                    <div class="field-description">
                        Badge-based competition percentage adjustment.
                    </div>
                    <div class="field-details">
                        <div class="field-detail">
                            <strong>What it does:</strong>
                            <span>Adjusts pricing based on badge tier differences</span>
                        </div>
                        <div class="field-detail">
                            <strong>Common values:</strong>
                            <span>5, 10, 15 (percentage adjustment)</span>
                        </div>
                    </div>
                </div>

                <div class="field-group">
                    <div class="field-name">
                        badgePercentageDown <span class="field-type">text value (percentage)</span>
                    </div>
                    <div class="field-description">
                        Specific percentage for competing down against badge sellers.
                    </div>
                    <div class="field-details">
                        <div class="field-detail">
                            <strong>What it does:</strong>
                            <span>Sets how much to undercut badge competitors</span>
                        </div>
                        <div class="field-detail">
                            <strong>When to use:</strong>
                            <span>When you want to price below badge sellers by a specific amount</span>
                        </div>
                        <div class="field-detail">
                            <strong>Example:</strong>
                            <span>Set to "10" to price 10% below lowest badge seller</span>
                        </div>
                    </div>
                </div>

                <h3>üöö Special Features</h3>

                <div class="field-group">
                    <div class="field-name">
                        is_nc_needed <span class="field-type">toggle (true/false)</span>
                    </div>
                    <div class="field-description">
                        Enables NC mode - shipping-inclusive pricing calculations.
                    </div>
                    <div class="field-details">
                        <div class="field-detail">
                            <strong>What it does:</strong>
                            <span>Switches to shipping-inclusive price comparisons</span>
                        </div>
                        <div class="field-detail">
                            <strong>When to use:</strong>
                            <span>When customers care about total delivered cost, not just unit price</span>
                        </div>
                        <div class="field-detail">
                            <strong>Effect:</strong>
                            <span>Uses reprice-helper-nc.ts instead of standard reprice-helper.ts</span>
                        </div>
                        <div class="field-detail">
                            <strong>Important:</strong>
                            <span>Compares (unit price + shipping) instead of unit price alone</span>
                        </div>
                    </div>
                </div>

                <div class="field-group">
                    <div class="field-name">
                        applyBuyBoxLogic <span class="field-type">toggle (true/false)</span>
                    </div>
                    <div class="field-description">
                        Prevents lowering prices when already in the buy box position.
                    </div>
                    <div class="field-details">
                        <div class="field-detail">
                            <strong>What it does:</strong>
                            <span>Maintains price when you're already winning (position #1)</span>
                        </div>
                        <div class="field-detail">
                            <strong>When to use:</strong>
                            <span>To maximize margins when already in the buy box</span>
                        </div>
                        <div class="field-detail">
                            <strong>Smart behavior:</strong>
                            <span>Only blocks decreases, still allows increases if market moves up</span>
                        </div>
                    </div>
                </div>

                <div class="field-group">
                    <div class="field-name">
                        applyNcForBuyBox <span class="field-type">toggle (true/false)</span>
                    </div>
                    <div class="field-description">
                        Automatically switches to NC mode when floor price is reached in buy box scenarios.
                    </div>
                    <div class="field-details">
                        <div class="field-detail">
                            <strong>What it does:</strong>
                            <span>Uses shipping-inclusive pricing as last resort to win buy box</span>
                        </div>
                        <div class="field-detail">
                            <strong>When triggered:</strong>
                            <span>When unit price hits floor but still not winning buy box</span>
                        </div>
                        <div class="field-detail">
                            <strong>Strategy:</strong>
                            <span>Compete on total cost when unit price flexibility is exhausted</span>
                        </div>
                    </div>
                </div>

                <div class="field-group">
                    <div class="field-name">
                        keepPosition <span class="field-type">toggle (true/false)</span>
                    </div>
                    <div class="field-description">
                        Maintains current ranking position, won't drop price to beat lower-ranked vendors.
                    </div>
                    <div class="field-details">
                        <div class="field-detail">
                            <strong>What it does:</strong>
                            <span>Prevents racing to bottom with vendors below your rank</span>
                        </div>
                        <div class="field-detail">
                            <strong>Example:</strong>
                            <span>If you're #2, won't lower price to beat #3, #4, etc.</span>
                        </div>
                        <div class="field-detail">
                            <strong>When to use:</strong>
                            <span>When position stability is more important than lowest price</span>
                        </div>
                    </div>
                </div>

                <h3>üîß Advanced Filters</h3>

                <div class="field-group">
                    <div class="field-name">
                        inventoryThreshold <span class="field-type">number</span>
                    </div>
                    <div class="field-description">
                        Minimum inventory level for vendors to be considered competition.
                    </div>
                    <div class="field-details">
                        <div class="field-detail">
                            <strong>What it does:</strong>
                            <span>Ignores vendors with inventory below this threshold</span>
                        </div>
                        <div class="field-detail">
                            <strong>Common values:</strong>
                            <span>5, 10, 20 (minimum units in stock)</span>
                        </div>
                        <div class="field-detail">
                            <strong>Strategy:</strong>
                            <span>Don't compete with vendors about to run out of stock</span>
                        </div>
                    </div>
                </div>

                <div class="field-group">
                    <div class="field-name">
                        handlingTimeFilter <span class="field-type">text value (days)</span>
                    </div>
                    <div class="field-description">
                        Filter vendors by maximum handling time in days.
                    </div>
                    <div class="field-details">
                        <div class="field-detail">
                            <strong>What it does:</strong>
                            <span>Only competes with vendors who ship within X days</span>
                        </div>
                        <div class="field-detail">
                            <strong>Common values:</strong>
                            <span>"5", "10", "15" (maximum days to ship)</span>
                        </div>
                        <div class="field-detail">
                            <strong>Example:</strong>
                            <span>Set to "5" to only compete with vendors shipping in 5 days or less</span>
                        </div>
                    </div>
                </div>

                <div class="field-group">
                    <div class="field-name">
                        ownVendorThreshold <span class="field-type">number</span>
                    </div>
                    <div class="field-description">
                        Your own shipping threshold value for free shipping calculations.
                    </div>
                    <div class="field-details">
                        <div class="field-detail">
                            <strong>What it does:</strong>
                            <span>Sets the order value for free shipping in NC calculations</span>
                        </div>
                        <div class="field-detail">
                            <strong>Common values:</strong>
                            <span>50, 75, 100 (free shipping threshold)</span>
                        </div>
                    </div>
                </div>
            </section>

            <section id="business-rules">
                <h2>üìã Business Rules Engine</h2>
                <p>The V1 algorithm applies these 12+ rules in sequence to refine pricing decisions. Rules are applied AFTER initial price calculation.</p>

                <div class="alert alert-info">
                    <strong>Rule Application Order:</strong> Rules are applied in the specific sequence shown below. Each rule can modify or block the pricing decision made by previous rules.
                </div>

                <div class="rule-card">
                    <div class="rule-name">
                        <span class="rule-number">1</span>
                        ApplyRule() - Pricing Direction Control
                    </div>
                    <div class="rule-description">
                        Enforces the pricing direction based on repricingRule setting (Up Only/Down Only/Both).
                    </div>
                    <div class="rule-example">
                        <strong>Example:</strong> If repricingRule=0 (Up Only) and algorithm calculates a decrease from $50 to $45, this rule blocks it and keeps price at $50.
                    </div>
                </div>

                <div class="rule-card">
                    <div class="rule-name">
                        <span class="rule-number">2</span>
                        ApplyFloorCheckRule() - Minimum Price Protection
                    </div>
                    <div class="rule-description">
                        Ensures prices never drop below the configured floor price for profitability protection.
                    </div>
                    <div class="rule-example">
                        <strong>Example:</strong> If floor is $10 and calculation suggests $8, price stays at $10 with "FLOOR_REACHED" message.
                    </div>
                </div>

                <div class="rule-card">
                    <div class="rule-name">
                        <span class="rule-number">3</span>
                        ApplyMultiPriceBreakRule() - Quantity Hierarchy
                    </div>
                    <div class="rule-description">
                        Ensures higher quantities have lower unit prices. Deactivates breaks that violate hierarchy.
                    </div>
                    <div class="rule-example">
                        <strong>Example:</strong> If Q1=$10, Q5=$12, Q10=$8, the Q5 break is deactivated as it's more expensive than Q1.
                    </div>
                </div>

                <div class="rule-card">
                    <div class="rule-name">
                        <span class="rule-number">4</span>
                        ApplySuppressPriceBreakRule() - Q1 Only Mode
                    </div>
                    <div class="rule-description">
                        When suppressPriceBreak=true, only Q1 prices change, all other quantities stay fixed.
                    </div>
                    <div class="rule-example">
                        <strong>Example:</strong> Q1 changes from $10 to $9, but Q5 stays at $8, Q10 stays at $7.
                    </div>
                </div>

                <div class="rule-card">
                    <div class="rule-name">
                        <span class="rule-number">5</span>
                        ApplyBeatQPriceRule() - Q1 Protection
                    </div>
                    <div class="rule-description">
                        Prevents Q1 from being beaten by competitors when beatQPrice=true.
                    </div>
                    <div class="rule-example">
                        <strong>Example:</strong> If your Q1 is $10 and competitor offers $9, keeps your Q1 at $10 for margin protection.
                    </div>
                </div>

                <div class="rule-card">
                    <div class="rule-name">
                        <span class="rule-number">6</span>
                        ApplyPercentagePriceRule() - Increase Limiter
                    </div>
                    <div class="rule-description">
                        Caps price increases to the specified percentage to prevent customer shock.
                    </div>
                    <div class="rule-example">
                        <strong>Example:</strong> If percentageIncrease=10 and current is $50, max new price is $55 (10% increase).
                    </div>
                </div>

                <div class="rule-card">
                    <div class="rule-name">
                        <span class="rule-number">7</span>
                        ApplyDeactivateQPriceBreakRule() - Prevent Deactivation
                    </div>
                    <div class="rule-description">
                        When abortDeactivatingQPriceBreak=true, keeps quantity breaks active even if not competitive.
                    </div>
                    <div class="rule-example">
                        <strong>Example:</strong> Q10 price break stays active even if no competitors offer Q10 pricing.
                    </div>
                </div>

                <div class="rule-card">
                    <div class="rule-name">
                        <span class="rule-number">8</span>
                        ApplyBuyBoxRule() - Winner Protection
                    </div>
                    <div class="rule-description">
                        If already in buy box (position #1), prevents unnecessary price decreases.
                    </div>
                    <div class="rule-example">
                        <strong>Example:</strong> You're at $50 and winning. New vendor at $48 arrives. You stay at $50 since you're still #1.
                    </div>
                </div>

                <div class="rule-card">
                    <div class="rule-name">
                        <span class="rule-number">9</span>
                        ApplyKeepPositionLogic() - Rank Maintenance
                    </div>
                    <div class="rule-description">
                        Won't lower price to compete with vendors ranked below current position.
                    </div>
                    <div class="rule-example">
                        <strong>Example:</strong> You're #2 at $50. #4 is at $45. You won't drop to $44 to beat #4, maintaining your #2 position.
                    </div>
                </div>

                <div class="rule-card">
                    <div class="rule-name">
                        <span class="rule-number">10</span>
                        ApplyRepriceDownBadgeCheckRule() - Badge Competition
                    </div>
                    <div class="rule-description">
                        Applies badgePercentageDown to compete specifically with badge sellers.
                    </div>
                    <div class="rule-example">
                        <strong>Example:</strong> Lowest badge seller at $50, badgePercentageDown=10%, your price becomes $45.
                    </div>
                </div>

                <div class="rule-card">
                    <div class="rule-name">
                        <span class="rule-number">11</span>
                        ApplySisterComparisonCheck() - Sister Vendor Differentiation
                    </div>
                    <div class="rule-description">
                        Ensures your price differs from sister vendors by reducing price by OFFSET amount.
                    </div>
                    <div class="rule-example">
                        <strong>Example:</strong> Sister vendor at $50.00, OFFSET=$0.01, your price becomes $49.99 to differentiate.
                    </div>
                </div>

                <div class="rule-card">
                    <div class="rule-name">
                        <span class="rule-number">12</span>
                        AppendNewPriceBreakActivation() - New Break Tracking
                    </div>
                    <div class="rule-description">
                        Adds #NEW tag when activating previously inactive price breaks.
                    </div>
                    <div class="rule-example">
                        <strong>Example:</strong> Q10 was $0 (inactive), now $8 (active), tagged with "#NEW" in execution log.
                    </div>
                </div>
            </section>

            <section id="nc-mode">
                <h2>üöö NC Mode - Shipping-Inclusive Pricing</h2>

                <h3>What is NC Mode?</h3>
                <p>NC (Net Cost) mode changes how the algorithm compares prices by including shipping costs in all calculations. Instead of comparing unit prices alone, it compares the total cost to the customer.</p>

                <div class="alert alert-info">
                    <strong>Key Concept:</strong> In NC mode, a higher unit price with free shipping might beat a lower unit price with expensive shipping.
                </div>

                <h3>How NC Mode Works</h3>
                <table>
                    <tr>
                        <th>Aspect</th>
                        <th>Standard Mode</th>
                        <th>NC Mode</th>
                    </tr>
                    <tr>
                        <td><strong>Price Comparison</strong></td>
                        <td>Unit price only</td>
                        <td>Unit price + shipping cost</td>
                    </tr>
                    <tr>
                        <td><strong>Example Calculation</strong></td>
                        <td>$45.00 vs $48.00</td>
                        <td>($45.00 + $8.99 shipping) vs ($48.00 + free shipping)</td>
                    </tr>
                    <tr>
                        <td><strong>Winner in Example</strong></td>
                        <td>$45.00 wins</td>
                        <td>$48.00 wins (total: $48 vs $53.99)</td>
                    </tr>
                    <tr>
                        <td><strong>Processing File</strong></td>
                        <td>reprice-helper.ts</td>
                        <td>reprice-helper-nc.ts</td>
                    </tr>
                    <tr>
                        <td><strong>Use Case</strong></td>
                        <td>Professional buyers who get free shipping</td>
                        <td>Retail customers who pay shipping</td>
                    </tr>
                </table>

                <h3>When to Enable NC Mode</h3>
                <div class="field-group">
                    <div class="field-name">Enable is_nc_needed when:</div>
                    <ul style="margin-left: 1.5rem; margin-top: 0.5rem;">
                        <li>Most customers pay for shipping</li>
                        <li>Competitors have varying shipping costs</li>
                        <li>You offer free shipping at certain thresholds</li>
                        <li>Total delivered cost matters more than unit price</li>
                        <li>Retail/consumer marketplace (vs B2B)</li>
                    </ul>
                </div>

                <h3>Special NC Buy Box Feature</h3>
                <div class="field-group">
                    <div class="field-name">
                        applyNcForBuyBox Behavior
                    </div>
                    <div class="field-description">
                        This advanced feature automatically switches to NC mode when your unit price hits the floor but you're still not winning the buy box.
                    </div>
                    <div class="rule-example">
                        <strong>Scenario:</strong><br>
                        1. Your unit price: $10 (floor price)<br>
                        2. Competitor: $10 + $5 shipping = $15 total<br>
                        3. You: $10 + free shipping = $10 total<br>
                        4. Algorithm switches to NC mode, you win buy box on total cost
                    </div>
                </div>

                <div class="alert alert-warning">
                    <strong>Important:</strong> NC mode calculations depend on accurate shipping threshold data. Ensure ownVendorThreshold is set correctly for your free shipping rules.
                </div>
            </section>

            <section id="advanced">
                <h2>üéØ Advanced Strategies</h2>

                <h3>Sister Vendor Exclusion Strategy</h3>
                <div class="strategy-card" style="background: linear-gradient(135deg, #f093fb, #f5576c);">
                    <h3>Managing Multiple Seller Accounts</h3>
                    <p class="strategy-description">Prevent your own accounts from competing against each other while maintaining differentiation.</p>
                    <div class="strategy-settings">
                        <div class="setting-row">
                            <span class="setting-name">competeAll</span>
                            <span class="setting-value">false</span>
                        </div>
                        <div class="setting-row">
                            <span class="setting-name">excludedVendors</span>
                            <span class="setting-value">17357;20722;20755 (your other vendor IDs)</span>
                        </div>
                        <div class="setting-row">
                            <span class="setting-name">Sister Logic Applied</span>
                            <span class="setting-value">ApplySisterComparisonCheck() ensures price differentiation</span>
                        </div>
                    </div>
                    <div style="margin-top: 1rem; opacity: 0.95;">
                        <strong>How it works:</strong> The algorithm ignores sister vendors for competition but ensures prices differ by OFFSET ($0.01) to avoid exact matches.
                    </div>
                </div>

                <h3>Badge Competition Strategy</h3>
                <div class="strategy-card" style="background: linear-gradient(135deg, #fa709a, #fee140);">
                    <h3>Competing Within Badge Tiers</h3>
                    <p class="strategy-description">Focus competition on vendors with similar credibility badges.</p>
                    <div class="strategy-settings">
                        <div class="setting-row">
                            <span class="setting-name">badgeIndicator</span>
                            <span class="setting-value">BADGE_ONLY</span>
                        </div>
                        <div class="setting-row">
                            <span class="setting-name">badgePercentageDown</span>
                            <span class="setting-value">10</span>
                        </div>
                        <div class="setting-row">
                            <span class="setting-name">Effect</span>
                            <span class="setting-value">Price 10% below lowest badge seller</span>
                        </div>
                    </div>
                    <div style="margin-top: 1rem; opacity: 0.95;">
                        <strong>Strategy:</strong> Maintain premium positioning while staying competitive within your badge tier.
                    </div>
                </div>

                <h3>Buy Box Protection Strategy</h3>
                <div class="strategy-card" style="background: linear-gradient(135deg, #4facfe, #00f2fe);">
                    <h3>Maximizing Margins When Winning</h3>
                    <p class="strategy-description">Protect profits when already in the buy box position.</p>
                    <div class="strategy-settings">
                        <div class="setting-row">
                            <span class="setting-name">applyBuyBoxLogic</span>
                            <span class="setting-value">true</span>
                        </div>
                        <div class="setting-row">
                            <span class="setting-name">keepPosition</span>
                            <span class="setting-value">true</span>
                        </div>
                        <div class="setting-row">
                            <span class="setting-name">repricingRule</span>
                            <span class="setting-value">0 (Up Only)</span>
                        </div>
                    </div>
                    <div style="margin-top: 1rem; opacity: 0.95;">
                        <strong>Result:</strong> Maintains winning position without unnecessary price cuts, allows increases when market moves up.
                    </div>
                </div>

                <h3>Multi-Quantity Break Strategy</h3>
                <div class="strategy-card" style="background: linear-gradient(135deg, #43e97b, #38f9d7);">
                    <h3>Optimizing Bulk Pricing</h3>
                    <p class="strategy-description">Manage quantity discounts while maintaining competitive single-unit pricing.</p>
                    <div class="strategy-settings">
                        <div class="setting-row">
                            <span class="setting-name">suppressPriceBreak</span>
                            <span class="setting-value">false</span>
                        </div>
                        <div class="setting-row">
                            <span class="setting-name">compareWithQ1</span>
                            <span class="setting-value">true</span>
                        </div>
                        <div class="setting-row">
                            <span class="setting-name">abortDeactivatingQPriceBreak</span>
                            <span class="setting-value">true</span>
                        </div>
                        <div class="setting-row">
                            <span class="setting-name">beatQPrice</span>
                            <span class="setting-value">true</span>
                        </div>
                    </div>
                    <div style="margin-top: 1rem; opacity: 0.95;">
                        <strong>Effect:</strong> Maintains attractive bulk discounts while protecting Q1 visibility and ensuring price hierarchy.
                    </div>
                </div>
            </section>

            <section id="dependencies">
                <h2>üîó Field Dependencies</h2>
                <p>Understanding how fields interact is crucial for proper configuration. Some settings require or conflict with others.</p>

                <div class="dependency-diagram">
                    <h3>Critical Field Relationships</h3>

                    <div class="dependency-row">
                        <div class="dependency-field">competeAll = false</div>
                        <span class="dependency-arrow">‚Üí</span>
                        <div class="dependency-field">excludedVendors must be set</div>
                    </div>

                    <div class="dependency-row">
                        <div class="dependency-field">suppressPriceBreak = true</div>
                        <span class="dependency-arrow">‚Üí</span>
                        <div class="dependency-field">suppressPriceBreakForOne activated</div>
                    </div>

                    <div class="dependency-row">
                        <div class="dependency-field">is_nc_needed = true</div>
                        <span class="dependency-arrow">‚Üí</span>
                        <div class="dependency-field">ownVendorThreshold required</div>
                    </div>

                    <div class="dependency-row">
                        <div class="dependency-field">badgeIndicator = BADGE_ONLY</div>
                        <span class="dependency-arrow">‚Üí</span>
                        <div class="dependency-field">badgePercentageDown applicable</div>
                    </div>

                    <div class="dependency-row">
                        <div class="dependency-field">repricingRule = 0 (Up)</div>
                        <span class="dependency-arrow">‚Üí</span>
                        <div class="dependency-field">percentageDown ignored</div>
                    </div>

                    <div class="dependency-row">
                        <div class="dependency-field">repricingRule = 1 (Down)</div>
                        <span class="dependency-arrow">‚Üí</span>
                        <div class="dependency-field">percentageIncrease ignored</div>
                    </div>
                </div>

                <h3>Setting Combinations to Avoid</h3>
                <table>
                    <tr>
                        <th>Conflicting Settings</th>
                        <th>Why It's a Problem</th>
                        <th>Solution</th>
                    </tr>
                    <tr>
                        <td>applyBuyBoxLogic=true + repricingRule=1 (Down Only)</td>
                        <td>Can't maintain buy box if only allowed to decrease</td>
                        <td>Use repricingRule=2 (Both)</td>
                    </tr>
                    <tr>
                        <td>floorPrice > maxPrice</td>
                        <td>Impossible price range</td>
                        <td>Ensure floor < max</td>
                    </tr>
                    <tr>
                        <td>keepPosition=true + aggressive percentageDown</td>
                        <td>Conflicts between maintaining position and aggressive pricing</td>
                        <td>Choose one strategy</td>
                    </tr>
                    <tr>
                        <td>beatQPrice=true + suppressPriceBreak=false</td>
                        <td>Q1 protection conflicts with multi-break updates</td>
                        <td>Usually use suppressPriceBreak=true with beatQPrice</td>
                    </tr>
                </table>
            </section>

            <section id="mistakes">
                <h2>‚ö†Ô∏è Common Mistakes</h2>

                <div class="troubleshooting-item">
                    <div class="problem">‚ùå Setting floor price too low</div>
                    <div>Trying to compete aggressively by setting floor below profitable levels.</div>
                    <div class="solution">‚úÖ Calculate true cost including fees, shipping, and minimum margin. Set floor accordingly.</div>
                </div>

                <div class="troubleshooting-item">
                    <div class="problem">‚ùå Using repricingRule=0 (Up Only) for competitive products</div>
                    <div>Prices only increase, never decrease, losing competitiveness over time.</div>
                    <div class="solution">‚úÖ Use repricingRule=2 (Both) for dynamic markets, reserve Up Only for inflation protection.</div>
                </div>

                <div class="troubleshooting-item">
                    <div class="problem">‚ùå Forgetting to set excludedVendors with competeAll=false</div>
                    <div>Algorithm tries to exclude sister vendors but doesn't know which ones.</div>
                    <div class="solution">‚úÖ Always provide semicolon-separated vendor IDs when competeAll=false.</div>
                </div>

                <div class="troubleshooting-item">
                    <div class="problem">‚ùå Enabling is_nc_needed without setting ownVendorThreshold</div>
                    <div>NC calculations fail because shipping threshold is unknown.</div>
                    <div class="solution">‚úÖ Set ownVendorThreshold to your free shipping minimum (e.g., 75 for $75+ free shipping).</div>
                </div>

                <div class="troubleshooting-item">
                    <div class="problem">‚ùå Setting percentageIncrease too high</div>
                    <div>Sudden price jumps shock customers and trigger competitive responses.</div>
                    <div class="solution">‚úÖ Keep percentageIncrease between 5-15% for gradual adjustments.</div>
                </div>

                <div class="troubleshooting-item">
                    <div class="problem">‚ùå Using beatQPrice without suppressPriceBreak</div>
                    <div>Trying to protect Q1 while updating all breaks creates conflicts.</div>
                    <div class="solution">‚úÖ Usually enable suppressPriceBreak=true when beatQPrice=true.</div>
                </div>

                <div class="troubleshooting-item">
                    <div class="problem">‚ùå Competing with all badges when you don't have one</div>
                    <div>Trying to match badge seller prices without badge credibility.</div>
                    <div class="solution">‚úÖ Focus on price competition or earn a badge first.</div>
                </div>

                <div class="troubleshooting-item">
                    <div class="problem">‚ùå Not using handlingTimeFilter for time-sensitive products</div>
                    <div>Competing with slow shippers on perishable or urgent items.</div>
                    <div class="solution">‚úÖ Set handlingTimeFilter="5" to only compete with fast shippers.</div>
                </div>

                <div class="troubleshooting-item">
                    <div class="problem">‚ùå Ignoring inventoryThreshold for scarce products</div>
                    <div>Adjusting prices based on competitors about to run out.</div>
                    <div class="solution">‚úÖ Set inventoryThreshold=10 to ignore low-stock competitors.</div>
                </div>

                <div class="troubleshooting-item">
                    <div class="problem">‚ùå Combining keepPosition with aggressive competition</div>
                    <div>Settings conflict: wanting to maintain position but also beat everyone.</div>
                    <div class="solution">‚úÖ Choose either position maintenance OR aggressive pricing strategy.</div>
                </div>
            </section>

            <section id="troubleshooting">
                <h2>üîß Troubleshooting Guide</h2>

                <h3>Prices Not Changing</h3>
                <div class="troubleshooting-item">
                    <div class="problem">Symptom: Algorithm runs but prices remain unchanged</div>
                    <div><strong>Check these settings:</strong></div>
                    <ul style="margin-left: 1.5rem;">
                        <li>‚úì repricingRule - might be blocking desired direction</li>
                        <li>‚úì floorPrice - might already be at floor</li>
                        <li>‚úì maxPrice - might already be at ceiling</li>
                        <li>‚úì applyBuyBoxLogic - might be maintaining buy box position</li>
                        <li>‚úì keepPosition - might be maintaining current rank</li>
                    </ul>
                    <div class="solution">Review execution logs for "IGNORED_" messages to identify blocking rules.</div>
                </div>

                <h3>Only Q1 Changing</h3>
                <div class="troubleshooting-item">
                    <div class="problem">Symptom: Single unit price updates but bulk prices stay fixed</div>
                    <div class="solution">Check suppressPriceBreak setting - if true, this is expected behavior. Set to false for all quantity updates.</div>
                </div>

                <h3>Competing with Sister Vendors</h3>
                <div class="troubleshooting-item">
                    <div class="problem">Symptom: Your accounts are undercutting each other</div>
                    <div class="solution">
                        1. Set competeAll=false<br>
                        2. Add vendor IDs to excludedVendors (semicolon-separated)<br>
                        3. ApplySisterComparisonCheck will ensure differentiation
                    </div>
                </div>

                <h3>Price Drops Too Much</h3>
                <div class="troubleshooting-item">
                    <div class="problem">Symptom: Aggressive price decreases hurting margins</div>
                    <div><strong>Adjust these settings:</strong></div>
                    <ul style="margin-left: 1.5rem;">
                        <li>‚Üë Increase floorPrice to protect minimum margin</li>
                        <li>‚Üì Decrease percentageDown for smaller adjustments</li>
                        <li>‚Üì Decrease badgePercentageDown if competing with badges</li>
                        <li>Enable keepPosition=true to avoid racing to bottom</li>
                        <li>Consider repricingRule=0 (Up Only) temporarily</li>
                    </ul>
                </div>

                <h3>Not Winning Buy Box</h3>
                <div class="troubleshooting-item">
                    <div class="problem">Symptom: Competitive price but not getting buy box</div>
                    <div><strong>Try these approaches:</strong></div>
                    <ul style="margin-left: 1.5rem;">
                        <li>Enable is_nc_needed=true for shipping-inclusive competition</li>
                        <li>Enable applyNcForBuyBox=true for automatic NC switching</li>
                        <li>Check if badge sellers have preference - adjust badgeIndicator</li>
                        <li>Verify handlingTimeFilter isn't excluding fast shippers</li>
                        <li>Consider your seller metrics and fulfillment speed</li>
                    </ul>
                </div>

                <h3>Price Increases Too Aggressive</h3>
                <div class="troubleshooting-item">
                    <div class="problem">Symptom: Prices jumping too quickly when competition leaves</div>
                    <div class="solution">
                        Reduce percentageIncrease to 5-10% for gradual adjustments. This prevents customer shock and maintains trust.
                    </div>
                </div>

                <h3>Quantity Breaks Not Competitive</h3>
                <div class="troubleshooting-item">
                    <div class="problem">Symptom: Bulk prices not attracting volume buyers</div>
                    <div><strong>Configuration fixes:</strong></div>
                    <ul style="margin-left: 1.5rem;">
                        <li>Set suppressPriceBreak=false to allow break updates</li>
                        <li>Enable compareWithQ1=true for meaningful discounts</li>
                        <li>Disable beatQPrice to allow aggressive Q2+ pricing</li>
                        <li>Review ApplyMultiPriceBreakRule effects in logs</li>
                    </ul>
                </div>

                <h3>Algorithm Ignoring Competitors</h3>
                <div class="troubleshooting-item">
                    <div class="problem">Symptom: Valid competitors not being considered</div>
                    <div><strong>Check filters:</strong></div>
                    <ul style="margin-left: 1.5rem;">
                        <li>inventoryThreshold - might be too high</li>
                        <li>handlingTimeFilter - might be too restrictive</li>
                        <li>badgeIndicator - might be filtering out non-badge sellers</li>
                        <li>excludedVendors - might accidentally include real competitors</li>
                    </ul>
                </div>

                <h3>NC Mode Not Working</h3>
                <div class="troubleshooting-item">
                    <div class="problem">Symptom: Shipping costs not being considered</div>
                    <div class="solution">
                        1. Verify is_nc_needed=true<br>
                        2. Set ownVendorThreshold to your free shipping minimum<br>
                        3. Check execution logs for "NC" tags<br>
                        4. Ensure shipping data is available for competitors
                    </div>
                </div>

                <h3>Rules Conflicting</h3>
                <div class="troubleshooting-item">
                    <div class="problem">Symptom: Multiple "IGNORED_" messages in execution log</div>
                    <div class="solution">
                        Review rule application order. Later rules override earlier ones. Check the business rules section to understand the sequence and adjust settings to avoid conflicts.
                    </div>
                </div>
            </section>

            <section id="comparison">
                <h2>üìä V1 vs V2 Comparison</h2>
                <p>Understanding the differences helps you decide when to migrate to V2 or stay with V1.</p>

                <div class="comparison-table">
                    <table>
                        <tr>
                            <th>Feature</th>
                            <th>V1 Algorithm</th>
                            <th>V2 Algorithm</th>
                            <th>Winner</th>
                        </tr>
                        <tr>
                            <td><strong>Configuration Fields</strong></td>
                            <td>~24 settings</td>
                            <td>27 fields</td>
                            <td class="feature-partial">Tie</td>
                        </tr>
                        <tr>
                            <td><strong>Architecture</strong></td>
                            <td>Rules-based (5 files)</td>
                            <td>Database-driven (single table)</td>
                            <td class="feature-yes">V2</td>
                        </tr>
                        <tr>
                            <td><strong>Price Strategies</strong></td>
                            <td>UNIT only</td>
                            <td>UNIT, TOTAL, BUY_BOX</td>
                            <td class="feature-yes">V2</td>
                        </tr>
                        <tr>
                            <td><strong>Badge Competition</strong></td>
                            <td>Basic (ALL/BADGE_ONLY)</td>
                            <td>4 strategies (ALL_ZERO, ALL_PERCENTAGE, BADGE_ONLY, NON_BADGE)</td>
                            <td class="feature-yes">V2</td>
                        </tr>
                        <tr>
                            <td><strong>Execution Priority</strong></td>
                            <td>Fixed order</td>
                            <td>Configurable priority (0-100)</td>
                            <td class="feature-yes">V2</td>
                        </tr>
                        <tr>
                            <td><strong>Sister Vendor Handling</strong></td>
                            <td>Exclude + differentiate</td>
                            <td>Explicit sister_vendor_ids field</td>
                            <td class="feature-yes">V2</td>
                        </tr>
                        <tr>
                            <td><strong>Competition Threshold</strong></td>
                            <td>inventoryThreshold only</td>
                            <td>inventory_competition_threshold with % support</td>
                            <td class="feature-yes">V2</td>
                        </tr>
                        <tr>
                            <td><strong>Learning Curve</strong></td>
                            <td>Simpler, fewer options</td>
                            <td>Complex, more options</td>
                            <td class="feature-yes">V1</td>
                        </tr>
                        <tr>
                            <td><strong>Setup Time</strong></td>
                            <td>Faster initial setup</td>
                            <td>Longer but more precise</td>
                            <td class="feature-yes">V1</td>
                        </tr>
                        <tr>
                            <td><strong>Flexibility</strong></td>
                            <td>Limited by rules</td>
                            <td>Highly configurable</td>
                            <td class="feature-yes">V2</td>
                        </tr>
                        <tr>
                            <td><strong>Debugging</strong></td>
                            <td>Follow rule sequence</td>
                            <td>v2_algo_execution table</td>
                            <td class="feature-yes">V2</td>
                        </tr>
                        <tr>
                            <td><strong>Performance</strong></td>
                            <td>5,103 lines of code</td>
                            <td>Optimized queries</td>
                            <td class="feature-yes">V2</td>
                        </tr>
                    </table>
                </div>

                <h3>When to Migrate to V2</h3>
                <div class="alert alert-success">
                    <strong>Consider migrating when you need:</strong>
                    <ul style="margin-top: 0.5rem; margin-left: 1.5rem;">
                        <li>Advanced badge competition strategies beyond basic filtering</li>
                        <li>TOTAL or BUY_BOX price strategies instead of just UNIT</li>
                        <li>Fine-grained execution priority control</li>
                        <li>Better debugging with v2_algo_execution logs</li>
                        <li>More sophisticated vendor exclusion rules</li>
                        <li>Database-driven configuration management</li>
                    </ul>
                </div>

                <h3>When to Stay with V1</h3>
                <div class="alert alert-info">
                    <strong>V1 remains suitable when:</strong>
                    <ul style="margin-top: 0.5rem; margin-left: 1.5rem;">
                        <li>Current configuration is working well</li>
                        <li>Simple pricing rules are sufficient</li>
                        <li>You prefer rules-based logic over database configuration</li>
                        <li>Quick setup is more important than advanced features</li>
                        <li>Integration with legacy systems requires V1</li>
                        <li>Team is already familiar with V1 operation</li>
                    </ul>
                </div>

                <h3>Migration Path</h3>
                <table>
                    <tr>
                        <th>Step</th>
                        <th>Action</th>
                        <th>Tools Available</th>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>Analyze current V1 settings</td>
                        <td>Export current configuration</td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>Map V1 fields to V2 equivalents</td>
                        <td>migrate-settings.ts script</td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>Configure V2 algorithm settings</td>
                        <td>V2AlgoSettingsForm.tsx UI</td>
                    </tr>
                    <tr>
                        <td>4</td>
                        <td>Test in parallel</td>
                        <td>v2_toggle feature flag</td>
                    </tr>
                    <tr>
                        <td>5</td>
                        <td>Compare results</td>
                        <td>v2_algo_execution logs</td>
                    </tr>
                    <tr>
                        <td>6</td>
                        <td>Gradual rollout</td>
                        <td>Product-by-product migration</td>
                    </tr>
                </table>
            </section>
        </main>

        <footer>
            <p>V1 Algorithm Field Guide - Version 1.0</p>
            <p>Last updated: November 2024</p>
            <p>For technical documentation, see: <a href="../api-core/v1-algorithm-detailed-documentation.html">V1 Algorithm Technical Documentation</a></p>
            <p>For V2 documentation, see: <a href="v2-algorithm-field-guide.html">V2 Algorithm Field Guide</a></p>
        </footer>
    </div>
</body>
</html>